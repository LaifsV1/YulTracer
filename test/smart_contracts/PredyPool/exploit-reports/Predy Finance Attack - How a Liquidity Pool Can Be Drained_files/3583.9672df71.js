"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["3583"],{22233:function(e,t,i){i.d(t,{Z:()=>n});let n=2787!=i.j?{icon:"icon-JCPlCw",toggleSetting:"toggleSetting-UDN_Qn",transcriptionPlayer:"transcriptionPlayer-eiECcl",hidePlayer:"hidePlayer-TfzId9",nonActiveText:"nonActiveText-JfTKb8",transcriptionChunk:"transcriptionChunk-bCQeJ2",editableChunk:"editableChunk-k4Fatu",startTime:"startTime-tjpyBE",text:"text-Ou5QC2",activeStartTime:"activeStartTime-ozZC_j",chunkWithSpeaker:"chunkWithSpeaker-iYPDkU",speaker:"speaker-GFTaOB",transcription:"transcription-hfRyWl",popover:"popover-tZdxdX",divider:"divider-ah0vWs",resultsValue:"resultsValue-uYlTxH",searchResult:"searchResult-_1_8Y9",isFocused:"isFocused-CIwNEb",searchForm:"searchForm-gEUJ79"}:null},15080:function(e,t,i){i.d(t,{Z:()=>n});let n=/^(3154|6909)$/.test(i.j)?{hasModal:"hasModal-bDnxNx",navItem:"navItem-LMkXsF",badge:"badge-WykKuV",navIcon:"navIcon-sYXN0z",dot:"dot-ffIU60",avatarActive:"avatarActive-DjlCWB",cta:"cta-p8wRyT",topNavContainer:"topNavContainer-_wO01o",topNav:"topNav-EFUPwm",searchInputContainer:"searchInputContainer-YrIW3p",kbd:"kbd-mlElYU",searchInput:"searchInput-dNEweF",sideNav:"sideNav-HN09Ay",profileSideNavContainer:"profileSideNavContainer-gREEbF",mobileNavContainer:"mobileNavContainer-rNnT3V",mobileNav:"mobileNav-enP9Hr",profileMenu:"profileMenu-dZh1Pk",startCta:"startCta-OwOerA",navCta:"navCta-KJigQ3",activeAvatar:"activeAvatar-zQSKs5",floatingCta:"floatingCta-RHNVs3",login:"login-y2i9b8",isLocked:"isLocked-eKFaD1",menuIcon:"menuIcon-xyWkqY",qrContainer:"qrContainer-mA2zEX",qrCode:"qrCode-FK0ZxH",modalViewer:"modalViewer-xO_gxg",active:"active-uB0ZZs","mobile-nav-on-island":"mobile-nav-on-island-kO5i22",mobileNavOnIsland:"mobile-nav-on-island-kO5i22","reader2-mobile-nav-icon":"reader2-mobile-nav-icon-ka9qcp",reader2MobileNavIcon:"reader2-mobile-nav-icon-ka9qcp",logo:"logo-DQBU5j"}:null},12936:function(e,t,i){i.d(t,{S$:()=>C,Su:()=>b,_e:()=>_});var n=i(16584),r=i(6400),a=i(30396),o=i(53836),l=i.n(o),s=i(97742);i(70522);var d=i(57391),c=i(95441),u=i(68833);i(62981);var p=i(98914);i(15771),i(19081),i(58175);var h=i(66611),v=i(60308);if(/^(3154|6909)$/.test(i.j))var Z=i(26111);if(i(63651),/^(3154|6909)$/.test(i.j))var m=i(81821);if(/^(3154|6909)$/.test(i.j))var f=i(47929);let g=(0,r.createContext)({hidden:!1});function b(){let{setHidden:e}=(0,a.qp)(g);return()=>null==e?void 0:e(!0)}function _(e){let{children:t}=e,[i,r]=(0,a.eJ)(!1);return(0,n.tZ)(g.Provider,{value:{hidden:i,setHidden:r},children:t})}function C(e){let{post:t,subdomain:i,readerInstalled:r,isContributor:o}=e,s=(0,m.s)()?"ios":(0,m.Dt)()?"android":null,{iString:h}=(0,c.M1)(),{hidden:b}=(0,a.qp)(g),{exposeExperiment:_,getExperimentVariant:C}=(0,d.jc)(),N=b||!s;if((0,a.d4)(()=>{N||!r||o||t.is_draft||(0,Z.x)("triedRedirect")||(0,p.AE)()?N||_("app_install_prompts"):(0,p.uX)((0,v.K8_)(i,t.slug,{params:{utm_medium:f.lP.web,utm_campaign:f.VX.postsOpenInApp,utm_source:f.b3.postBanner}}))},[]),N)return null;let S=C("app_install_prompts")||"none";if(!["our_banner","native_banner_if_supported"].includes(S))return null;let x=h("Read in the Substack app");"podcast"==t.type?x=h("Listen in the Substack app"):"video"==t.type&&(x=h("Watch in the Substack app"));let I=(0,v.K8_)(i,t.slug,{redirect:"app-store",source:f.b3.postBanner});return(0,m.IT)()&&"native_banner_if_supported"===S?(0,n.BX)(n.HY,{children:[(0,n.tZ)(l(),{meta:[{name:"apple-itunes-app",content:"app-id=1581650857, app-argument=".concat(I)}]}),(0,n.tZ)(P,{surface:"post",bannerType:"safari-native-app-banner"})]}):(0,n.BX)(w,{className:"app-banner-post",children:[(0,n.tZ)(P,{surface:"post"}),(0,n.tZ)(y,{}),(0,n.tZ)(k,{children:(0,n.tZ)("div",{children:x})}),(0,n.tZ)("a",{className:"app-banner-cta",href:I,onClick:()=>{(0,u.j)(u.FP.APP_BANNER_TAPPED,{surface:"post",type:"header"})},children:h("Open app")})]})}function P(e){let{surface:t,bannerType:i}=e;return(0,a.d4)(()=>{(0,u.j)(u.FP.APP_BANNER_VIEWED,{surface:t,bannerType:i})},[]),null}let w=(0,h.L)("app-banner"),k=(0,h.L)("app-banner-text");function y(){return(0,n.tZ)("div",{className:"app-banner-icon",children:(0,n.tZ)(s.Z,{height:16})})}},72508:function(e,t,i){i.d(t,{ZP:()=>M,ml:()=>F,sZ:()=>$});var n=i(7409),r=i(99282),a=i(16584),o=i(30396),l=i(94184),s=i.n(l),d=i(74691),c=i.n(d),u=i(18029),p=i.n(u),h=i(44908),v=i.n(h),Z=i(40423),m=i(96862),f=i(3039),g=i(19298),b=i(80569),_=i.n(b),C=i(61649),P=i(29032),w=i(93678),k=i(44881),y=i(95441),N=i(57952),S=i(96904),x=i(53030),I=i(68833),E=i(33224),T=i(71068),R=i(19081),O=i(58175),B=i(17564),D=i(74571),j=i(61468),A=i(84864),L=i(93370),X=i(24271),U=i(63523);function M(e){var t,i;let{disableSelection:l,player:s,postId:d,renderTranscriptionChunk:u,transcription:p,onUpdateActiveRowIndex:h}=e,{iString:Z}=(0,y.M1)(),{onStartClipping:m}=(0,C.Sr)(),f=(0,o.sO)(null),{selection:g,clearSelection:b,selectEndRef:P,selectStartRef:w}=(0,D.LW)({containerRef:f,disable:null!=l&&l,playerRef:s}),[T,B]=(0,o.eJ)(!0),[A,L]=(0,o.eJ)(),[X,M]=(0,o.eJ)(["nick","mills"]),[F,$]=(0,o.eJ)({}),[H,G]=(0,o.eJ)(!1),[J,q]=(0,o.eJ)(!1),[Y,K]=(0,o.eJ)(),{currentTime:Q,isPlaying:ee}=(0,x.FI)(s),et=F?Object.values(F).filter(e=>e):[],ei=!!((null==X?void 0:X.length)&&et.length),{setItems:en}=(0,N.pH)(),er=null==A?void 0:A.findIndex(e=>e.start<=Q&&e.end>Q);if((0,o.d4)(()=>{h&&void 0!==er&&-1!==er&&h(er)},[er,h]),(0,o.d4)(()=>{B(!0),p.cdn_url&&_().get(p.cdn_url).then(e=>{if(!e.text)return;let t=JSON.parse(e.text),i=(0,j.Ap)({rows:t});L(i),en(i);let n=v()(i.map(e=>{var t;return null!==(t=e.speaker)&&void 0!==t?t:""})).filter(e=>e).sort();n.length&&M(n)}).finally(()=>{B(!1)}),p.speaker_map&&Object.values(p.speaker_map).length&&$(p.speaker_map)},[null==A?void 0:A.length,en,p.cdn_url,p.cdn_unaligned_url,p.speaker_map]),T)return(0,a.tZ)(V,{});if(!(null==A?void 0:A.length))return(0,a.tZ)("div",{className:U.Z.transcriptionStatus,children:(0,a.tZ)(O.xv.Meta,{children:Z((null==p?void 0:p.status)==="in_progress"?"Transcription in progress...":"No transcript...")})});let ea=(null==s?void 0:null===(i=s.current)||void 0===i?void 0:null===(t=i.player)||void 0===t?void 0:t.tagName)==="VIDEO",eo=ea?"videogram":"audiogram";return(0,a.BX)(R.tu,{ref:f,children:[g&&(0,a.tZ)(z,{isVideo:ea,selection:g,onSelect:ea?()=>{if(!g||!A||!w.current||!P.current)return;let e=w.current,t=P.current;(e.rowIndex>t.rowIndex||e.rowIndex===t.rowIndex&&e.offset>t.offset)&&([e,t]=[t,e]);let i=(0,E.xm)({startRow:A[e.rowIndex],endRow:A[t.rowIndex],startOffset:e.offset,endOffset:t.offset,startNodeText:e.text,endNodeText:t.text});b(),m((0,r._)((0,n._)({},i),{source:"transcription",title:null}))}:function(){if(g&&P.current&&w.current&&A){let e=(0,n._)({},w.current),t=(0,n._)({},P.current),[i,r]=(0,E.lF)({selectStart:e,selectEnd:t,alignedRows:A});i>r&&([i,r]=[r,i]),G(!0),_().post("/api/v1/audiogram").send({post_id:d,start_idx:i,end_idx:r,use_draft:!1}).then(e=>{var t,i;(null===(t=e.body)||void 0===t?void 0:t.data)&&(K(e.body.data),b(),(null==s?void 0:null===(i=s.current)||void 0===i?void 0:i.player)&&s.current.player.pause())}).finally(()=>G(!1))}}}),u&&A.map((e,t)=>{var i;return u({isPlaying:ee,row:e,rowIndex:t,words:e.words,showSpeaker:(0===t?void 0:null===(i=A[t-1])||void 0===i?void 0:i.speaker)!==e.speaker,speakerName:ei&&e.speaker?F[e.speaker]:void 0,onPause:()=>{var e;(null==s?void 0:null===(e=s.current)||void 0===e?void 0:e.player)&&s.current.player.pause()},onPlay:()=>{var t;(null==s?void 0:null===(t=s.current)||void 0===t?void 0:t.player)&&(s.current.player.currentTime=e.start+1e-4,s.current.player.play())}})}),!u&&A.map((e,t)=>(0,a.tZ)(W,{idx:t,row:e,rows:A,speakerName:ei&&e.speaker?F[e.speaker]:void 0,onReassign:()=>q(!0),currentTime:Q,isPlaying:ee,isSelected:!!(g&&P.current&&w.current&&t===c()(t,Math.min(w.current.rowIndex,P.current.rowIndex),Math.max(w.current.rowIndex,P.current.rowIndex))),onClick:()=>{b()},onPause:()=>{var e;(null==s?void 0:null===(e=s.current)||void 0===e?void 0:e.player)&&s.current.player.pause()},onPlay:()=>{var t;(null==s?void 0:null===(t=s.current)||void 0===t?void 0:t.player)&&(s.current.player.currentTime=e.start+1e-4,s.current.player.play())}},t)),(0,a.tZ)(S.G,{isOpen:!!(H||Y),onClose:()=>K(void 0),isGenerating:H,finishedGram:Y,noun:eo,postId:d,onDownload:function(e){return(0,I.j)(I.FP.AUDIOGRAM_DOWNLOAD_CLICKED,{post_id:d,audiogram_id:null==Y?void 0:Y.id,media_upload_id:p.media_upload_id}),fetch(e,{method:"GET"}).then(e=>e.blob()).then(e=>{var t;let i=null==Y?void 0:null===(t=Y.video_url)||void 0===t?void 0:t.split("/").pop(),n=null==i?void 0:i.match(/^([^-]+-[^_]+)_/),r=(null==n?void 0:n[1])||"",a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download="substack-".concat(eo,"-").concat(d,"-").concat(r,".mp4"),document.body.appendChild(o),o.click(),URL.revokeObjectURL(a),o.remove()})}}),(0,a.tZ)(k.O,{isOpen:X&&!!X.length&&!!J,onClose:()=>q(!1),speakers:X,speakerMap:F,onChangeSpeakerMap:$,postId:d})]})}function z(e){var t,i;let{isVideo:n,selection:r,onSelect:o}=e,{iString:l}=(0,y.M1)(),d=null===(i=r.anchorNode)||void 0===i?void 0:null===(t=i.parentElement)||void 0===t?void 0:t.getBoundingClientRect();return d?(0,a.tZ)(P.C,{children:(0,a.tZ)(R.tu,{style:{top:(0,A.isTouchDevice)()?Math.max(d.y,0)+d.height+12:Math.max(d.bottom,0)+12,left:d.x+d.width/2,transform:"translateX(-50%)",pointerEvents:"auto",maxWidth:240},justifyContent:"center",outline:"detail",shadow:"md",radius:"md",className:s()(X.Z.popover,X.Z.mounted),padding:4,gap:4,children:n?(0,a.BX)(w.O7,{onClick:o,children:[(0,a.tZ)(Z.Z,{color:"var(--color-utility-white)",size:20}),(0,a.tZ)(O.xv.B4,{color:"white",weight:"medium",children:l("Create clip")})]}):(0,a.BX)(w.O7,{onClick:o,children:[(0,a.tZ)(m.Z,{color:"var(--color-utility-white)",size:20}),(0,a.tZ)(O.xv.B4,{color:"white",weight:"medium",children:l("Make audiogram")})]})})}):null}function V(){return(0,a.BX)(a.HY,{children:[(0,a.tZ)(B.S,{width:"80%",height:"24px",className:U.Z.loadingSilhouette}),(0,a.tZ)(B.S,{width:"34%",height:"24px",className:U.Z.loadingSilhouette}),(0,a.tZ)(B.S,{width:"75%",height:"24px",className:U.Z.loadingSilhouette}),(0,a.tZ)(B.S,{width:"100%",height:"24px",className:U.Z.loadingSilhouette}),(0,a.tZ)(B.S,{width:"68%",height:"24px",className:U.Z.loadingSilhouette})]})}function F(e){if(!e)return"Unknown Speaker";let t=e.split("_"),i=parseInt(t[1]);return"".concat(p()(t[0])," ").concat(i+1)}function W(e){let{row:t,currentTime:i,onPlay:l,isPlaying:d,onPause:c,isSelected:u,onClick:p,idx:h,rows:v,onReassign:Z,speakerName:m}=e,[b,_]=(0,o.eJ)(!1),C=(0,o.sO)(null),P=t.start<=i&&t.end>=i,w=t.words.map(e=>e.start<=i&&e.end>=i?(0,a.BX)(a.HY,{children:[(0,a.tZ)("span",{className:U.Z.activeWord,children:e.word})," "]}):"".concat(e.word," "));w.length||(w=t.text.split(" ").map(e=>(0,a.BX)("span",{children:[e," "]})));let k=null;if(t.speaker&&m){var y;let e=0===h?void 0:null===(y=v[h-1])||void 0===y?void 0:y.speaker;t.speaker!==e&&(k=(0,a.tZ)("div",{className:U.Z.speakerText,onClick:Z,children:m}))}return(0,a.BX)("div",{ref:C,onClick:p,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),style:{display:"flex",width:"100%",alignItems:"center"},children:[d&&(!b||P)?(0,a.tZ)(g.Z,{onClick:c,size:24,className:U.Z.playCircle,style:(0,r._)((0,n._)({},b&&{color:"var(--color-accent-themed)"}),{visibility:P||b?"visible":"hidden"})}):(0,a.tZ)(f.Z,{onClick:l,size:24,className:U.Z.playCircle,style:(0,r._)((0,n._)({},b&&{color:"var(--color-accent-themed)"}),{visibility:P||b?"visible":"hidden"})}),(0,a.BX)("div",{className:s()(U.Z.transcriptionChunk,{[U.Z.activeRow]:P||u,[U.Z.hoverChunk]:b}),"data-chunk-index":h,children:[(0,a.tZ)("div",{className:s()(U.Z.rowIndicator,{[U.Z.hoverRow]:b})}),(0,a.BX)("div",{style:{display:"flex",flexDirection:"column",flex:1,padding:"5px 0"},children:[k,(0,a.tZ)("div",{className:U.Z.rowText,"data-chunk-index":h,children:w})]})]})]})}let $=e=>{let{isActiveRow:t,isPlaying:i,row:n,rowIndex:r,onPause:o,onPlay:l,postId:d,children:c,className:u,activeClassName:p,editable:h}=e,v=t&&i;return(0,a.tZ)(T.xu,{id:"transcription-".concat(r),paddingRight:16,className:s()(u,{[null!=p?p:""]:v}),onClick:()=>{var e;(null===(e=window.getSelection())||void 0===e||!e.toString())&&!h&&((0,I.j)(I.FP.TRANSCRIPTION_TIMESTAMP_CLICKED,{post_id:d,timestamp:(0,L.DL)(n.start)}),v?o():l())},children:c})}},2689:function(e,t,i){if(i.d(t,{Z:()=>s}),/^(3154|6909)$/.test(i.j))var n=i(7409);if(/^(3154|6909)$/.test(i.j))var r=i(99282);if(/^(3154|6909)$/.test(i.j))var a=i(98848);var o=i(16584),l=i(64515);let s=/^(3154|6909)$/.test(i.j)?e=>{var{size:t=20,fill:i="var(--color-fg-primary)"}=e,s=(0,a._)(e,["size","fill"]);return(0,o.tZ)(l.l,(0,r._)((0,n._)({},s),{name:"PauseIconFilled",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:i,children:(0,o.tZ)("path",{stroke:"none",d:"M5.29883 17.9082H7.52539C8.375 17.9082 8.82422 17.459 8.82422 16.5996V3.29883C8.82422 2.41016 8.375 2 7.52539 2H5.29883C4.44922 2 4 2.44922 4 3.29883V16.5996C4 17.459 4.44922 17.9082 5.29883 17.9082ZM12.3984 17.9082H14.6152C15.4746 17.9082 15.9141 17.459 15.9141 16.5996V3.29883C15.9141 2.41016 15.4746 2 14.6152 2H12.3984C11.5391 2 11.0898 2.44922 11.0898 3.29883V16.5996C11.0898 17.459 11.5391 17.9082 12.3984 17.9082Z"})}))}:null},55438:function(e,t,i){i.d(t,{Z:()=>d});var n=i(7409),r=i(99282),a=i(98848),o=i(16584),l=i(64515),s=i(90406);let d=e=>{var{svgParams:t}=e,i=(0,a._)(e,["svgParams"]);return(0,o.BX)(l.l,(0,r._)((0,n._)({},i),{name:"SubstackIcon",svgParams:(0,n._)({height:1e3,width:1e3,fill:s.Hu,stroke:"none"},t),children:[(0,o.tZ)("path",{d:"M764.166 348.371H236.319V419.402H764.166V348.371Z"}),(0,o.tZ)("path",{d:"M236.319 483.752V813.999L500.231 666.512L764.19 813.999V483.752H236.319Z"}),(0,o.tZ)("path",{d:"M764.166 213H236.319V284.019H764.166V213Z"})]}))}},30363:function(e,t,i){i.d(t,{ZP:()=>c});var n=i(16584),r=i(94184),a=i.n(r),o=i(55438),l=i(90406),s=i(38841);let d=e=>{let{publication:t,logo_size:i=60,className:r="",children:d}=e;return(0,n.tZ)("table",{role:"presentation",className:a()("publication","card",r,t.logo_url?"has-logo":"no-logo"),width:"auto",cellpadding:0,cellspacing:0,border:"0",children:(0,n.BX)("tr",{cellpadding:"0",height:"100%",children:[i&&(0,n.tZ)("td",{rowspan:3,className:"logo",children:(0,n.tZ)("figure",{className:"logo",children:t.logo_url?(0,n.tZ)(s.CN,{pub:t,size:i}):(0,n.tZ)(o.Z,{isStatic:!0,fill:t.theme_var_background_pop||l.Hu,width:i,height:i})})}),(0,n.tZ)("td",{children:(0,n.BX)("table",{cellpadding:"0",cellspacing:"0",children:[(0,n.tZ)("tr",{children:(0,n.tZ)("td",{className:"title",children:t.name})}),(0,n.tZ)("tr",{cellpadding:"0",height:"80%",children:(0,n.tZ)("td",{className:"description",children:t.hero_text})}),d]})})]})})},c=e=>{let{publication:t,logo_size:i=60,isStatic:r=!1,children:a}=e;return r?(0,n.tZ)(d,{publication:t,logo_size:i,children:a}):(0,n.BX)("div",{className:"publication card",children:[i&&(0,n.tZ)("figure",{className:"logo",children:(0,n.tZ)(s.wk,{pub:t,size:i})}),(0,n.BX)("div",{className:"title",children:[(0,n.tZ)("div",{className:"name",children:t.name}),(0,n.tZ)("div",{className:"description",children:t.hero_text}),a]})]})}},8845:function(e,t,i){i.d(t,{C:()=>d,T:()=>s});var n=i(16584),r=i(6400),a=i(30396),o=i(6070);let l=(0,r.createContext)({theme:null,setTheme:()=>void 0}),s=()=>(0,a.qp)(l),d=e=>{var t;let{pub:i,post:r,children:s}=e,[d,c]=(0,a.eJ)(null!==(t=null==r?void 0:r.postTheme)&&void 0!==t?t:null);return(0,o.HD)({pub:i})?(0,n.tZ)(l.Provider,{value:{theme:d,setTheme:c},children:s}):(0,n.tZ)(n.HY,{children:s})}},96904:function(e,t,i){i.d(t,{G:()=>v});var n=i(58865),r=i(16584),a=i(71212),o=i(33804),l=i(95441),s=i(68833),d=i(15771),c=i(6490),u=i(98248);function p(){let e=(0,n._)(["Generating ","..."]);return p=function(){return e},e}function h(){let e=(0,n._)(["Shareable ",""]);return h=function(){return e},e}function v(e){let{isOpen:t,onClose:i,isGenerating:n,finishedGram:v,noun:Z,postId:m,onDownload:f}=e,{iString:g,iTemplate:b}=(0,l.M1)();return(0,r.tZ)(c.u_,{isOpen:t,onClose:i,children:(0,r.BX)(o.w,{children:[(0,r.tZ)(c.xB,{title:b(n?p():h(),Z),showClose:!0,showDivider:!0,onClose:i}),(0,r.tZ)(c.fe,{children:v?(0,r.tZ)("video",{src:v.cdn_url,style:{borderRadius:12},controls:!0,download:!0,width:400}):(0,r.tZ)(u.$j,{alignItems:"center",justifyContent:"center",minHeight:220})}),v&&(0,r.tZ)(c.mz,{direction:"column",primaryButton:(0,r.tZ)(d.zx,{priority:"primary",leading:(0,r.tZ)(a.Z,{size:20}),onClick:()=>{(0,s.j)(s.FP.AUDIOGRAM_DOWNLOAD_CLICKED,{post_id:m,audiogram_id:null==v?void 0:v.id,media_upload_id:null==v?void 0:v.media_upload_id}),f(v.cdn_url)},children:g("Download")})})]})})}},78118:function(e,t,i){i.r(t),i.d(t,{ReaderOnboardingModal:()=>D,ReaderOnboardingModalWithUserContext:()=>j,TwitterStage:()=>R});var n=i(27412),r=i(7409),a=i(99282),o=i(98848),l=i(16584),s=i(98661),d=i(30396),c=i(97742),u=i(93666),p=i(32582),h=i(57391),v=i(60807),Z=i(68833),m=i(98914),f=i(341),g=i(57601),b=i(64799),_=i(14861),C=i(4564),P=i(45930),w=i(76971),k=i(48146),y=i(48450),N=i(7759),S=i(29191),x=i(76560),I=i(60308),E=i(63651),T=i(81821);let R=e=>{let{user:t,useProfilePrefix:i}=e;return(null==t?void 0:t.has_linked_twitter)?(0,l.tZ)(B,{user:t,useProfilePrefix:i}):(0,l.tZ)(O,{})},O=()=>{let[e,t]=(0,d.eJ)(!0);return(0,l.BX)("div",{className:"inbox-access-form link-twitter",children:[(0,l.tZ)(c.Z,{className:"onboarding-main-icon",width:38,height:43}),(0,l.tZ)("h2",{children:"Find writers you follow"}),(0,l.tZ)("section",{className:"twitter-description",children:"Find writers you know on Substack, and let your Twitter followers find you. We’ll never post without your permission."}),(0,l.tZ)("p",{children:(0,l.BX)("label",{className:"let-others-find-me",children:[(0,l.tZ)("input",{type:"checkbox",checked:e,onChange:()=>t(!e)}),"Let others find me via Twitter"]})}),(0,l.tZ)(p.PH,{linkType:"reader",discoverable:e,icon:!1,text:"Connect Twitter"}),(0,l.tZ)("a",{className:"skip",href:"".concat((0,I.ZJn)(),"/profile/fill"),native:!0,children:"Skip for now"})]})},B=e=>{let{user:t,useProfilePrefix:i}=e;return(0,l.tZ)(p.G6,{user:t,onSignup:()=>{let e=(null==t?void 0:t.profile_set_up_at)?(0,I.HMK)():"".concat((0,I.ZJn)(),"/profile/fill");(0,m.uX)(e)},buttonText:"Continue",requireSignup:!1,needsEmailConfirm:!1,useProfilePrefix:i})};class D extends u.p{componentDidMount(){super.componentDidMount(),(0,T.tq)()&&(this.context.exposeExperiment("reader_onboarding_app_first"),this.inAppExperimentTreatment())}componentWillReceiveProps(e){this.setState({skipRedirectOnExit:e.skipRedirectOnExit,zIndex:e.zIndex,entry:e.entry,onBeforeClose:e.onBeforeClose})}getDefaultStep(){return this.state.appOnboardingTreatment?x.c.APP_UPSELL:x.c.CATEGORIES}inAppExperimentTreatment(){if(this.state.appOnboardingTreatment)return this.state.appOnboardingTreatment;let e=(0,T.tq)()&&["treatment","treatment_no_skip"].includes(this.context.getExperimentVariant("reader_onboarding_app_first"));return e&&this.setState({step:x.c.APP_UPSELL,appOnboardingTreatment:!0}),e}openForPub(e,t){this.setState({pub:e,profile:t,step:t?this.props.user?x.c.CATEGORIES:x.c.PUB_SIGNUP:x.c.PUB_LANDING}),this.open()}openToPubSignup(e){this.setState({pub:e,step:x.c.PUB_SIGNUP,profile:null}),this.open()}setStep(e){if(e===x.c.APP_UPSELL&&this.state.appOnboardingTreatment&&this.state.previousStepData[x.c.APP_UPSELL]&&(e=x.c.WELCOME),(0,Z.j)(Z.FP.READER_ONBOARDING_STEP_CHANGED,{from_step:this.state.step,to_step:e,modal:!0}),e===x.c.EXIT){if(this.state.skipRedirectOnExit)this.close();else{var t;let e=null!==(t=this.redirect)&&void 0!==t?t:this.state.pub&&"reader2"===this.state.entry?(0,I.SVA)(this.state.pub):(0,E.E2n)();document.location.href=e}}else setTimeout(()=>this.setState({step:e}),0)}setPreviousStepData(e,t){this.setState({previousStepData:(0,a._)((0,r._)({},this.state.previousStepData),{[e]:t})})}getClassName(){return"reader-onboarding-modal wide"}onClose(){(0,Z.j)(Z.FP.READER_ONBOARDING_MODAL_CLOSED,{entry:this.props.entry,step:this.state.step}),this.setStep(this.getDefaultStep())}onOpen(){var e;(0,Z.j)(Z.FP.READER_ONBOARDING_MODAL_OPENED,{entry:this.props.entry,step:this.state.step,for_pub_id:null===(e=this.state.pub)||void 0===e?void 0:e.id})}handleError(e){let{ignore:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{step:i}=this.state;console.error("Error in reader onboarding ".concat(i," step: ").concat(e)),(0,Z.j)(Z.FP.READER_ONBOARDING_ERROR,{step:i,entry:this.props.entry,ignore:t}),t||this.setStep(x.c.ERROR)}renderStep(){let e=this.props,{ref:t}=e,i=(0,o._)(e,["ref"]),{step:n,open:s,pub:d,profile:c,previousStepData:u,appOnboardingTreatment:p}=this.state,h={setStep:this.setStep,handleError:this.handleError,close:this.close,setPreviousStepData:this.setPreviousStepData,appOnboardingTreatment:p};if(!s)return null;switch(n){case x.c.SIGNUP:return(0,l.tZ)(y.Z,(0,a._)((0,r._)({},i,h),{previousStepData:u}));case x.c.PUB_LANDING:return(0,l.tZ)(w.Z,(0,a._)((0,r._)({},i,h),{pub:d}));case x.c.PUB_SIGNUP:return(0,l.tZ)(k.Z,(0,a._)((0,r._)({},i,h),{pub:d,profile:null!=c?c:null}));case x.c.CATEGORIES:return(0,l.tZ)(C.r,(0,a._)((0,r._)({},i,h),{pub:d}));case x.c.PROFILE:return(0,l.tZ)(P.Z,(0,r._)({},i,h));case x.c.START_WRITING:return(0,l.tZ)(N.Z,(0,r._)({},i,h));case x.c.CREATE_PUBLICATION:return(0,l.tZ)(g.Z,(0,r._)({},i,h));case x.c.CREATE_PUBLICATION_SUCCESS:return(0,l.tZ)(b.Z,(0,a._)((0,r._)({},i,h),{previousStepData:u}));case x.c.ERROR:return(0,l.tZ)(_.Z,(0,r._)({},i,h));case x.c.APP_UPSELL:return(0,l.tZ)(f.Z,{onComplete:()=>{this.setPreviousStepData(x.c.APP_UPSELL,!0),p?this.setStep(x.c.CATEGORIES):this.setStep(x.c.WELCOME)}});case x.c.WELCOME:default:return(0,l.tZ)(S.Z,(0,a._)((0,r._)({},i,h),{pub:d,profile:null!=c?c:null}))}}renderChildren(){return(0,l.tZ)("div",{className:"reader-onboarding-modal-container",children:this.renderStep()})}constructor(e,t){var i;super(e,t),(0,n._)(this,"redirect",void 0),this.setStep=this.setStep.bind(this),this.state.pub=e.pub||null,this.handleError=this.handleError.bind(this),this.state.previousStepData={},this.setPreviousStepData=this.setPreviousStepData.bind(this),this.state.skipRedirectOnExit=null!==(i=e.skipRedirectOnExit)&&void 0!==i&&i,this.redirect=e.redirect&&"/"!==e.redirect?e.redirect:null,this.state.appOnboardingTreatment=!1,this.state.step=e.step||this.getDefaultStep()}}(0,n._)(D,"contextType",h.kx);let j=(0,s.forwardRef)((e,t)=>{let i=(0,v.SE)(),n=e.onBeforeClose,o=n?()=>n(i.user):void 0,s=(0,a._)((0,r._)({},e),{onBeforeClose:o,user:i.user});return(0,l.tZ)(D,(0,a._)((0,r._)({},s),{ref:t}))})},90565:function(e,t,i){i(16584),i(30396),i(94184),i(95441),i(9682),i(80026),i(69891),i(58175),i(74949),i(83010),i(50312),i(60308)},71512:function(e,t,i){i(16584),i(83034),i(95441),i(68833),i(15771),i(19081),i(15080)},3573:function(e,t,i){i(16584),i(30396),i(94184),i(78718),i(98585),i(9682),i(80026),i(91400),i(60308)},5623:function(e,t,i){i.d(t,{R5:()=>eI});var n=i(7409),r=i(99282),a=i(98848);if(/^(3154|6909)$/.test(i.j))var o=i(58865);var l=i(16584),s=i(98661),d=i(30396),c=i(94184),u=i.n(c);if(/^(3154|6909)$/.test(i.j))var p=i(18693);if(/^(3154|6909)$/.test(i.j))var h=i(84967);if(/^(3154|6909)$/.test(i.j))var v=i(49336);if(/^(3154|6909)$/.test(i.j))var Z=i(71375);if(/^(3154|6909)$/.test(i.j))var m=i(8618);if(/^(3154|6909)$/.test(i.j))var f=i(7617);if(/^(3154|6909)$/.test(i.j))var g=i(31131);if(/^(3154|6909)$/.test(i.j))var b=i(13808);if(/^(3154|6909)$/.test(i.j))var _=i(85200);if(/^(3154|6909)$/.test(i.j))var C=i(99869);if(/^(3154|6909)$/.test(i.j))var P=i(77600);if(/^(3154|6909)$/.test(i.j))var w=i(44276);if(/^(3154|6909)$/.test(i.j))var k=i(77475);if(/^(3154|6909)$/.test(i.j))var y=i(47655);if(/^(3154|6909)$/.test(i.j))var N=i(20817);if(/^(3154|6909)$/.test(i.j))var S=i(98643);if(/^(3154|6909)$/.test(i.j))var x=i(59543);if(/^(3154|6909)$/.test(i.j))var I=i(7073);var E=i(61649),T=i(59708),R=i(51455),O=i(50137),B=i(2689),D=i(9970),j=i(26582),A=i(51534),L=i(96726),X=i(56219),U=i(94442),M=i(67203),z=i(10878),V=i(75697),F=i(47851),W=i(72392),$=i(95441),H=i(93155),G=i(40647),J=i(60807),q=i(6246),Y=i(68833),K=i(48980),Q=i(7882),ee=i(21599);i(9682);var et=i(32129),ei=i(94874),en=i(15771),er=i(19081),ea=i(84370),eo=i(36500),el=i(98248),es=i(38841),ed=i(58175),ec=i(70379),eu=i(87077),ep=i(40949),eh=i(74312),ev=i(81043),eZ=i(65575),em=i(44312),ef=i(32189),eg=i(39493),eb=i(61412),e_=i(91400),eC=i(64172),eP=i(60308),ew=i(63651),ek=i(84864);if(/^(3154|6909)$/.test(i.j))var ey=i(47929);var eN=i(78691);function eS(){let e=(0,o._)(["You subscribed to "," by "," because it was recommended by ","."]);return eS=function(){return e},e}function ex(){let e=(0,o._)(["You subscribed to "," because it was recommended by ","."]);return ex=function(){return e},e}function eI(e){var t;let i=(0,ev.SJ)();return(0,d.d4)(()=>()=>{var e;null===(e=i.setDrawer)||void 0===e||e.call(i,null)},[]),i.setDrawer&&null!==(t=i.setDrawer((0,l.tZ)(eT,(0,n._)({},e))))&&void 0!==t?t:null}function eE(e){var t,i,a,o,s,c,m,f,g,b,_,C,P;let w,{postId:k,post:y,publication:N,videoPlayerRef:S,onClose:x,onPrevious:I,onNext:E,onSave:R,onArchive:O,onLike:L,onLoad:U,isArchived:M,publicationSettings:F,referringRecommendation:H,referringPub:G}=e,[q,et]=(0,d.eJ)(!1),[eo,eh]=(0,d.eJ)(!1),eg=(0,eC.Th)(),eb=(0,ef.x)({surface:"post-viewer"}),eP=(0,J.aF)(),eI=(0,e_.XA)(),eE=(0,ec.pm)(),{iString:eT,iTemplate:eO}=(0,$.M1)(),ej=(0,d.sO)(null);(0,d.d4)(()=>{(0,Y.j)(Y.FP.POST_VIEWER_VIEWED,{post_id:k})},[k]);let eX=(0,ep.y)(),eU=(0,d.I4)(()=>{(0,Y.j)(Y.FP.POST_VIEWER_CLOSED,{post_id:k}),x()},[x,k]),eM=O&&(e=>{(0,Y.j)(Y.FP.POST_ARCHIVED,{post_id:e,surface:"post viewer"}),O(e)});y&&N&&F&&(w={post:y,publication:N,publicationSettings:F,referringRecommendation:H,referringPub:G});let ez=new URLSearchParams(document.location.search),{result:eV,isLoading:eF}=(0,Q.ib)({pathname:"/api/v1/posts/by-id/".concat(k),query:{preview:null!==(m=ez.get("postPreview"))&&void 0!==m?m:void 0},deps:[k],auto:!w,initialResult:w});(0,d.d4)(()=>{eV&&eg.updatePublication(eV.publication.id,eV)},[eV]);let eW=(0,ee.S2)(null,{ignoreSafari:!0});(0,d.d4)(()=>{U&&eV&&U(eV)},[eV]),(0,d.d4)(()=>{eV&&eW.postSelection&&eW.highlightSelection()},[eV,eW.postSelection]);let e$=null!==(f=null==eV?void 0:eV.publication)&&void 0!==f?f:N,eH=null!==(g=null==eV?void 0:eV.publicationSettings)&&void 0!==g?g:{},eG=(null==e$?void 0:e$.payments_state)==="enabled",{subscription:eJ,publicationUser:eq,isFreeSubscribed:eY,isPaid:eK,isAuthor:eQ,isPledged:e0}=(0,eC.Y0)(null!==(b=null==eV?void 0:null===(t=eV.post)||void 0===t?void 0:t.publication_id)&&void 0!==b?b:0),e1=!(eG?eK:eK||eY),[e9,e4]=(0,d.eJ)(!1),e8=(0,d.sO)(0),{setIsReading:e6}=(0,ev.SJ)(),e3=async e=>{let{reportCategory:t,details:i}=e;await (0,K.rd)("/api/v1/publications/".concat(null==e$?void 0:e$.id,"/posts/").concat(k,"/report"),{method:"POST",json:{details:i,reportCategory:t}}),et(!1),eE.popToast(e=>(0,l.tZ)(ec.FN,(0,r._)((0,n._)({},e),{text:eT("We received your report"),Icon:p.Z})))},e2=eV&&(C=eV.post,P=y,(0,n._)({},C,Object.fromEntries(Object.entries(null!=P?P:{}).filter(e=>{let[t,i]=e;return null!=i})))),e5=(0,T.N1)(null!==(_=null==eV?void 0:null===(i=eV.post)||void 0===i?void 0:i.body_html)&&void 0!==_?_:""),e7=eV&&(null===(a=eV.publication)||void 0===a?void 0:a.id)?null===(o=eg.result)||void 0===o?void 0:o.publicationUserMap.get(eV.publication.id):void 0,te=eV&&e7&&["admin","contributor"].includes(e7.role)?()=>{(0,Y.j)(Y.FP.READER_EDIT_POST_BUTTON_CLICKED,{publication_id:eV.publication.id,post_id:eV.post.id}),location.href=(0,ew.ANx)(eV.publication,eV.post.id,{addBase:!0})}:void 0,{activePost:tt,isPlaying:ti,onToggle:tn,onPlay:tr}=(0,em.G)(),ta=!!(ti&&tt&&tt.id===(null==eV?void 0:eV.post.id)),to=(null==eV?void 0:eV.post)&&(0,X.sY)(eV.post);return(0,l.BX)(er.hs,{id:"post-viewer",className:eN.Z.viewerContainer,padding:12*!eI,minWidth:0,children:[(0,l.tZ)(z.u,{isOpen:q,onSubmit:e3,onClose:()=>et(!1)}),(0,l.BX)(er.tu,(0,r._)((0,n._)({className:u()(eN.Z.viewer,e9&&eN.Z.isReading),bg:"primary",flex:"grow",position:"relative",minWidth:0},eI?null:{border:"detail",radius:"md"}),{children:[(0,l.BX)(er.tu,{className:eN.Z.viewerOffset,flex:"grow",children:[(0,l.BX)(er.hs,{className:eN.Z.nav,justifyContent:"space-between",paddingY:16,alignItems:"center",children:[(0,l.tZ)(er.hs,{className:eN.Z.logoContainer,justifyContent:"center",zIndex:-1,children:eF?(0,l.tZ)(eZ.Vm,{size:40}):e$&&(0,l.tZ)(er.hs,{as:"a",href:(0,ew.SVA)(e$),children:(0,l.tZ)(es.wk,{pub:e$,size:40,shadow:"sm",radius:"sm"})})}),(0,l.tZ)(er.hs,{gap:8,children:(0,l.tZ)(eL,{onClick:eU})}),(0,l.BX)(er.hs,{gap:8,children:[!eI&&!eQ&&e$&&(0,l.tZ)(en.zx,{priority:e1?"primary":"secondary",rounded:!0,newTab:!0,href:(0,ew.W1P)(e$,{user:eP,addBase:!0,params:{utm_source:ey.b3.substack,utm_medium:ey.lP.web,utm_campaign:ey.VX.postViewer}}),onClick:e=>{if(!eP&&e$){eb(e$)(e);return}setTimeout(()=>{eg.refetchPublication(e$.id)},5e3)},children:(0,l.tZ)(er.gq,{alignItems:"center",gap:8,children:e1?(0,ek.getSubscribeText)(e$,{isFreeSubscribed:eY}):"Subscribed"})}),(null==eV?void 0:eV.post)&&(0,X.a7)(eV.post)&&(0,l.tZ)(eu.u,{leading:to?(0,l.tZ)(A.Z,{size:12}):void 0,text:to?"Paid subscribers only":"Play audio",preferPlacement:"bottom-center",hoverOptions:{delayEnter:0,delayLeave:0},children:(0,l.tZ)(en.hU,{onClick:()=>{!to&&(ta?tn():tr({post:eV.post,publication:eV.publication}))},disabled:to,children:to?(0,l.tZ)(j.Z,{size:20,fill:"var(--color-fg-secondary)"}):ta?(0,l.tZ)(B.Z,{size:20}):(0,l.tZ)(D.Z,{size:20})})}),eF?(0,l.tZ)(eZ.Vm,{radius:"sm",size:40}):eV&&(0,l.tZ)(eA,{post:eV.post,publication:e$,onArchive:eM,onSavePost:R,onCopyLink:()=>{eX((0,V.O1)(null,{post:y,pub:e$,user:eP,useCustomDomainOverOpen:!0}))},onReport:()=>et(!0),onEditPost:te,isArchived:M})]})]}),(0,l.BX)(er.tu,{className:eN.Z.content,flex:"grow",children:[(E||I)&&(0,l.BX)(er.tu,{gap:8,className:eN.Z.navArrows,children:[(0,l.tZ)(eu.u,{text:"Previous post",trailing:(0,l.tZ)(ea.T,{children:"K"}),preferPlacement:"right-center",children:(0,l.tZ)(en.hU,{onClick:null!=I?I:void 0,disabled:!I,tabIndex:2,className:eN.Z.navArrow,children:(0,l.tZ)(h.Z,{size:20})})}),(0,l.tZ)(eu.u,{text:"Next post",trailing:(0,l.tZ)(ea.T,{children:"J"}),preferPlacement:"right-center",children:(0,l.tZ)(en.hU,{onClick:null!=E?E:void 0,disabled:!E,tabIndex:1,className:eN.Z.navArrow,children:(0,l.tZ)(v.Z,{size:20})})})]}),(0,l.tZ)(er.tu,{className:eN.Z.post,flex:"grow",onScroll:e=>{let t=e.currentTarget,i=t.scrollTop;i>t.scrollHeight-t.offsetHeight-100?(e4(!1),null==e6||e6(!1)):i>e8.current?(e4(!0),null==e6||e6(!0)):(e4(!1),null==e6||e6(!1)),e8.current=i},ref:ej,children:eF?(0,l.tZ)(er.tu,{flex:"grow",alignItems:"center",justifyContent:"center",children:(0,l.tZ)(el.$j,{})}):eV&&eV.post.id===k&&(0,l.BX)(l.HY,{children:[!eo&&!!eV.referringPub&&(0,l.BX)(er.hs,{position:"relative",className:u()(!eI&&"container",eN.Z.referringPubContainer),radius:"md",shadow:"sm",border:"detail",gap:16,padding:16,children:[(0,l.tZ)(er.hs,{className:eN.Z.close,position:"absolute",cursor:"pointer",onClick:async()=>{await (0,K.rd)("/api/v1/publication_user_settings/user",{method:"PUT",json:{publication_id:eV.publication.id,type:"hide_referring_recommendation",value:!0}}),eh(!0)},children:(0,l.tZ)(Z.Z,{size:16,strokeWidth:1})}),!eI&&(0,l.tZ)(ei.qE,{user:{id:eV.referringPub.author_id,name:eV.referringPub.author_name},photoUrl:eV.referringPub.author_photo_url,size:56}),(0,l.tZ)(er.tu,{alignItems:"start",gap:16,className:eN.Z.referringPubTextContainer,children:(0,l.BX)(er.tu,{gap:4,paddingRight:24,children:[(0,l.BX)(ed.xv.B3,{fontWeight:"semibold",children:[eV.publication.author_name?eO(eS(),eV.publication.name,eV.publication.author_name,eV.referringPub.author_name||eV.referringPub.name):eO(ex(),eV.publication.name,eV.referringPub.author_name||eV.referringPub.name)," ",(0,l.BX)(ed.xv.B3,{as:"span",translated:!0,children:["Manage your subscription"," ",(0,l.tZ)(ed.xv.B3,{as:"a",href:(0,ew.zRj)(eV.publication),decoration:"underline",children:"here"}),"."]})]}),(null===(s=eV.referringRecommendation)||void 0===s?void 0:s.description)&&(0,l.BX)(ed.xv.B4,{color:"secondary",children:["“",null===(c=eV.referringRecommendation)||void 0===c?void 0:c.description,"”"," ","–"," ",eV.referringPub.author_name||eV.referringPub.name]})]})})]}),(0,l.tZ)(eR,{post:e2,publication:eV.publication,publicationUser:eq,subscription:eJ,publicationSettings:eH,isPledged:e0,postContainerRef:ej,videoPlayerRef:S})]})})]}),(0,l.tZ)(er.hs,{className:eN.Z.bottomNav,justifyContent:"center",borderTop:"detail",children:(0,l.tZ)(er.hs,{className:eN.Z.ufi,justifyContent:"space-between",alignItems:"center",gap:32,children:eF?(0,l.tZ)(eD,{}):eV&&e2&&(0,l.tZ)(eB,{publication:eV.publication,post:e2,user:eP,onLike:L})})})]}),e5&&(0,l.tZ)(W.o,{toc:e5,position:"absolute"})]}))]})}let eT=e=>{let t=(0,d.sO)(null);return(0,l.tZ)(E.BY,{postId:e.postId,videoPlayerRef:t,children:(0,l.tZ)(eE,(0,r._)((0,n._)({},e),{videoPlayerRef:t}))})};function eR(e){let{post:t,publication:a,publicationUser:o,subscription:s,publicationSettings:d,isPledged:c,postContainerRef:u,videoPlayerRef:p}=e,h=(0,G.xR)(),v=(0,J.aF)(),Z=v?(0,r._)((0,n._)({},v),{is_contributor:(null==o?void 0:o.role)==="contributor",is_admin:(null==o?void 0:o.role)==="admin",is_public_admin:!!(null==o?void 0:o.public),is_subscribed:(null==s?void 0:s.membership_state)==="subscribed",is_free_subscribed:(null==s?void 0:s.membership_state)==="free_signup",is_pledged:c}):null;return(0,l.BX)(J.dr,{defaultValue:Z,children:[(0,l.tZ)(et.PostMetaTags,{post:t,publication:a,siteConfigs:h.allConfigs}),(0,l.tZ)(eh.cr,{module:"@/frontend/reader2/PostRenderer",onRequest:()=>i.e("2926").then(i.bind(i,81033)),resolve:e=>e.ReaderPost,post:t,pub:a,user:Z,publicationSettings:d,postContainerRef:u,videoPlayerRef:p})]})}let eO=(0,s.forwardRef)((e,t)=>{var{count:i,children:o,tooltipText:s,tooltipTrailing:d,disabled:c}=e,u=(0,a._)(e,["count","children","tooltipText","tooltipTrailing","disabled"]);return(0,l.tZ)(er.hs,{justifyContent:"center",alignItems:"center",ref:t,children:(0,l.tZ)(eu.u,{preferPlacement:"top-center",text:null!=s?s:"",trailing:d,disabled:c,children:(0,l.BX)(en.hU,(0,r._)((0,n._)({priority:"tertiary",disabled:c},u),{children:[o,null!=i&&i>0&&(0,l.tZ)(ed.xv.B4,{weight:"bold",color:c?"tertiary":"primary",children:null!=i?(0,q.T)(i):"0"})]}))})})});function eB(e){var t;let{publication:i,post:n,user:r,onLike:a}=e,o=(0,d.sO)(),s=!!n.reaction,c=null!==(t=n.reactions["❤"])&&void 0!==t?t:0,p=!r||!i.community_enabled,h=(0,ek.showCommentsOnPost)({publication:i,post:n});return(0,eb.B)({name:"share",action:()=>{var e;null===(e=o.current)||void 0===e||e.open()}}),(0,l.BX)(l.HY,{children:[(0,l.tZ)(eO,{className:u()(eN.Z.ufiButton,eN.Z.likeButton,s&&eN.Z.isLiked),onClick:a?()=>a(n.id,!s):void 0,count:c,disabled:p,tooltipText:"Like",tooltipTrailing:(0,l.tZ)(ea.T,{children:"L"}),children:(0,l.tZ)(m.Z,{size:20})}),(0,l.tZ)(eO,{href:"profile"===i.homepage_type?(0,ew.mx9)(i,n):(0,eP.uRy)(i,n,{comments:!0,urlParams:{utm_source:ey.b3.substack,utm_medium:ey.lP.web,utm_campaign:ey.VX.postViewer}}),count:n.comment_count,newTab:"profile"!==i.homepage_type,disabled:p||!h,className:u()(eN.Z.ufiButton,eN.Z.commentButton),tooltipText:"Comment",children:(0,l.tZ)(f.Z,{size:20})}),(0,l.tZ)(ej,{pub:i,post:n}),(0,l.tZ)(M.sp,{post:n,user:r||void 0,pub:i,showClipping:!!n.videoUpload,trigger:(0,l.tZ)(eO,{className:u()(eN.Z.ufiButton,eN.Z.shareButton),tooltipText:"Share",children:(0,l.tZ)(g.Z,{height:20,strokeWidth:2})})}),(0,l.tZ)(L.h,{children:(0,l.tZ)(F.Z,{ref:o,medium:"post viewer",user:r,post:n,pub:i,onClick:e=>e.preventDefault()})})]})}function eD(){return(0,l.BX)(l.HY,{children:[(0,l.tZ)(eO,{disabled:!0,children:(0,l.tZ)(m.Z,{size:20})}),(0,l.tZ)(eO,{disabled:!0,children:(0,l.tZ)(f.Z,{size:20})}),(0,l.tZ)(eO,{disabled:!0,children:(0,l.tZ)(b.Z,{size:20})}),(0,l.tZ)(eO,{disabled:!0,children:(0,l.tZ)(g.Z,{height:20,strokeWidth:2})})]})}function ej(e){let{pub:t,post:i}=e,a=!(0,J.aF)()||!t.community_enabled,[o,s]=(0,d.eJ)(!!i.restacked),[c,p]=(0,d.eJ)(Number(i.restacks)),{canRestack:h,menuItems:v,nuxModal:Z}=(0,eg.K)({pub:t,post:(0,r._)((0,n._)({},i),{restacked:o,restacks:c}),onRestack:e=>{o!==e&&p(c+(e?1:-1)),s(e)}});return h?(0,l.BX)(l.HY,{children:[Z,(0,l.tZ)(eo.v2,{trigger:(0,l.tZ)(eO,{className:u()(eN.Z.restackButton,eN.Z.ufiButton,o&&eN.Z.isRestacked),count:c,disabled:a,tooltipText:"Restack","aria-label":"menu",children:(0,l.tZ)(O.Z,{className:eN.Z.actionIcon})}),children:v})]}):null}function eA(e){let{post:t,publication:i,onArchive:n,onSavePost:r,onCopyLink:a,onReport:o,onEditPost:s,isArchived:d}=e,{isSaved:c,onSave:u}=(0,U.vk)({post:t}),{iString:p}=(0,$.M1)(),{openModal:h,closeModal:v}=(0,H.dd)(),{activePost:Z,isPlaying:m,onToggle:f,onPlay:g}=(0,em.G)(),E=!!(m&&Z&&Z.id===t.id);return(0,l.BX)(eo.v2,{trigger:(0,l.tZ)(en.hU,{"aria-label":"View more",priority:"secondary",children:(0,l.tZ)(_.Z,{size:20})}),children:[(0,l.tZ)(eo.sN,{onClick:a,leading:(0,l.tZ)(C.Z,{}),children:p("Copy link")}),(0,l.tZ)(eo.sN,{leading:(0,l.tZ)(P.Z,{}),onClick:()=>{h({children:(0,l.tZ)(R.I,{post:t,pub:i,onClose:v}),width:540})},children:p("Embed")}),(0,l.BX)(eo.xw,{children:[(0,X.a7)(t)&&!(0,X.sY)(t)&&(0,l.tZ)(eo.sN,{onClick:()=>{E?f():g({post:t,publication:i})},leading:E?(0,l.tZ)(w.Z,{}):(0,l.tZ)(k.Z,{}),trailing:(0,l.tZ)(ea.T,{children:"P"}),children:p(E?"Pause audio":"Play audio")}),r&&(0,l.tZ)(eo.sN,{onClick:()=>r({post:t,isSaved:u()}),target:"_blank",leading:c?(0,l.tZ)(y.Z,{}):(0,l.tZ)(b.Z,{}),trailing:(0,l.tZ)(ea.T,{children:"S"}),children:p(c?"Unsave":"Save")}),n&&(d?(0,l.tZ)(eo.sN,{onClick:()=>n(t.id),leading:(0,l.tZ)(N.Z,{}),trailing:(0,l.tZ)(ea.T,{children:"E"}),children:p("Unarchive")}):(0,l.tZ)(eo.sN,{onClick:()=>n(t.id),leading:(0,l.tZ)(S.Z,{}),trailing:(0,l.tZ)(ea.T,{children:"E"}),children:p("Archive")})),s&&(0,l.tZ)(eo.xw,{children:(0,l.tZ)(eo.sN,{onClick:s,leading:(0,l.tZ)(x.Z,{}),children:p("Edit post")})})]}),(0,l.tZ)(eo.xw,{children:o&&(0,l.tZ)(eo.sN,{priority:"destructive",onClick:o,leading:(0,l.tZ)(I.Z,{}),children:p("Report")})})]})}function eL(e){let{onClick:t}=e;return(0,l.tZ)(eu.u,{text:"Close",trailing:(0,l.tZ)(ea.T,{children:"ESC"}),preferPlacement:"right-center",children:(0,l.tZ)(en.hU,{onClick:t,priority:"secondary","aria-label":"Close",children:(0,l.tZ)(Z.Z,{size:20,"aria-hidden":!0})})})}},82075:function(e,t,i){i(16584),i(15771),i(19081)},22029:function(e,t,i){i(16584),i(9682),i(15771),i(91400),i(33884)},88603:function(e,t,i){i(16584),i(95441),i(15771),i(63651)},7935:function(e,t,i){i(16584),i(60807),i(68833),i(7882),i(98914),i(94874),i(15771),i(19081),i(84747),i(38841),i(78096),i(70379),i(60308)},7779:function(e,t,i){i(16584),i(4473),i(40647),i(15771),i(80026),i(33884),i(15080)},3:function(e,t,i){i.d(t,{r:()=>O});var n=i(16584),r=i(30396),a=i(27484),o=i.n(a);if(/^(3154|6909)$/.test(i.j))var l=i(24840);var s=i(83320),d=i(22259),c=i(87698),u=i(46411),p=i(89320),h=i(60982),v=i(9997),Z=i(890),m=i(98585),f=i(99259),g=i(36518),b=i(85095),_=i(60807),C=i(9682),P=i(98914),w=i(80026),k=i(72260),y=i(19434),N=i(50802),S=i(3561),x=i(75419),I=i(33884),E=i(63651);if(/^(3154|6909)$/.test(i.j))var T=i(47929);var R=i(15080);function O(e){var t,i;let{requireLogin:a,setDrawer:O,drawer:B,native:D}=e,j=(0,_.aF)(),{viewerProfile:A}=(0,b.Un)(),[L]=(0,C.tv)(),{activityUnreadCount:X}=(0,g.lR)(),U=(0,f.M$)().isOnDestination,[M,z]=(0,r.eJ)(null),V={urlParams:{utm_content:T.fZ.islandDesktopNavSidebar}},F=U?I.Ds:(0,E.n1t)((0,E.SVA)(),{utm_content:T.fZ.islandDesktopNavSidebar}),W=U?null:(0,E.ze_)(V);(0,r.d4)(()=>{if("undefined"!=typeof window){let e=window.localStorage.getItem("chatLastClicked");e&&z(o()(e))}},[]);let $=(null==A?void 0:null===(t=A.publicationUsers)||void 0===t?void 0:t.find(e=>"admin"===e.role||"contributor"===e.role))||{publication:null==j?void 0:null===(i=j.dashboard_pubs)||void 0===i?void 0:i[0]},H=(0,x.i3)(),{chatUnreadCount:G,useChatBadge:J}=(0,k.L)({chatLastClicked:M}),{open:q}=(0,m.Dr)();return(0,n.tZ)(w.sg,{role:"navigation","aria-label":"Main navigation","aria-orientation":"vertical",className:U?"":R.Z.profileSideNavContainer,children:(0,n.tZ)(w.sg,{position:"fixed",bg:"primary",className:R.Z.sideNav,children:(0,n.tZ)(w.sg,{flex:"grow",children:(0,n.BX)(w.sg,{flex:"grow",sizing:"border-box",borderRight:"detail",width:72,children:[(0,n.BX)(w.sg,{padding:8,gap:8,justifyContent:"center",flex:"grow",children:[(0,n.tZ)(S.u,{href:F,icon:(0,n.tZ)(p.Z,{}),activeIcon:(0,n.tZ)(h.Z,{}),label:"Home",native:!!D,isActive:!B&&void 0}),(0,n.tZ)(S.u,{href:U?E.Gfh:(0,E.ozY)(V),icon:(0,n.tZ)(v.Z,{}),activeIcon:(0,n.tZ)(Z.Z,{}),requireLogin:a,label:"Subscriptions",native:!!D,isActive:!B&&void 0}),(0,n.tZ)(S.u,{href:U?E.Don:(0,E.Cnj)(V),icon:(0,n.tZ)(c.Z,{}),activeIcon:(0,n.tZ)(u.Z,{}),requireLogin:a,badge:G,dot:!!J,native:!!D,label:"Chat",onClick:()=>{O&&O(null),z(o()()),window.localStorage.setItem("chatLastClicked",o()().toISOString())},isActive:!B&&void 0}),(0,n.tZ)(S.u,{onClick:()=>{O?O("activity"===B?null:"activity"):W&&(0,P.uX)(W)},isActive:"activity"===B,icon:(0,n.tZ)(s.Z,{}),activeIcon:(0,n.tZ)(d.Z,{}),requireLogin:a,badge:X,label:"Activity"}),(0,n.tZ)(S.u,{onClick:()=>{U?q():(0,P.uX)((0,E.k7R)(V))},icon:(0,n.tZ)(l.Z,{}),label:"Search"}),(0,n.tZ)(w.sg,{alignItems:"center",paddingY:8,children:(0,n.tZ)(y.z,{onNoteClick:e=>{let{isPost:t}=e;O&&O(null),H.open({onCompose:()=>{(0,I.Z2)(L.path)?((0,P.uX)("/inbox",{replace:!0}),setTimeout(()=>{(0,P.uX)(I.Ds,{replace:!0})},0)):(0,P.uX)(F)},isPost:t})},profile:A,publicationUser:$})})]}),(0,n.tZ)(w.sg,{padding:8,gap:8,justifyContent:"center",children:j&&(0,n.tZ)(N.D,{})})]})})})})}},24641:function(e,t,i){i(16584),i(95441),i(15771),i(91400)},76404:function(e,t,i){i.d(t,{I:()=>w});var n=i(16584),r=i(94184),a=i.n(r);if(/^(3154|6909)$/.test(i.j))var o=i(38464);var l=i(87698),s=i(46411),d=i(85626),c=i(89320),u=i(60982),p=i(9997),h=i(890),v=i(99259),Z=i(49762),m=i(19081),f=i(72260),g=i(13434),b=i(33884),_=i(63651);if(/^(3154|6909)$/.test(i.j))var C=i(47929);var P=i(15080);function w(e){let{requireLogin:t}=e,i=(0,v.M$)().isOnDestination,{chatUnreadCount:r}=(0,f.L)({}),w={noBase:!1,urlParams:{utm_content:C.fZ.islandDesktopNavSidebar}},k=i?b.Ds:(0,_.n1t)((0,_.SVA)(),{utm_content:C.fZ.islandDesktopNavSidebar});return(0,n.tZ)(m.hs,{className:P.Z.mobileNavContainer,children:(0,n.BX)(m.hs,{className:a()(P.Z.mobileNav,i?null:P.Z.mobileNavOnIsland),flex:"grow",alignItems:"center",justifyContent:"space-between",borderTop:"detail",paddingX:64,children:[(0,n.tZ)(g.P,{href:k,icon:(0,n.tZ)(c.Z,{}),activeIcon:(0,n.tZ)(u.Z,{}),requireLogin:t,native:!i}),(0,n.tZ)(g.P,{href:i?_.Gfh:(0,_.ozY)(w),icon:(0,n.tZ)(p.Z,{}),activeIcon:(0,n.tZ)(h.Z,{}),requireLogin:t,native:!i}),(0,n.tZ)(Z.SiteConfigGate,{configKey:"web_reader_podcasts_tab",children:(0,n.tZ)(g.P,{href:"/podcasts-player",icon:(0,n.tZ)(o.Z,{strokeWidth:1.8*26/30,size:30,stroke:"var(--color-fg-primary)"}),activeIcon:(0,n.tZ)(d.Z,{strokeWidth:1.8*26/30,size:30,stroke:"var(--color-fg-primary)"}),requireLogin:t})}),(0,n.tZ)(g.P,{href:i?(0,_.Cnj)():(0,_.Cnj)(w),icon:(0,n.tZ)(l.Z,{}),activeIcon:(0,n.tZ)(s.Z,{}),requireLogin:t,badge:r,native:!i,className:P.Z.reader2MobileNavIcon})]})})}},57449:function(e,t,i){i(16584),i(58175)},33740:function(e,t,i){i(16584),i(12757)},15850:function(e,t,i){i(16584);var n=i(98661);i(30396);var r=i(23493),a=i.n(r);(0,n.createContext)({listeningProgress:{},onUpdateListeningProgress:()=>void 0});let o=e=>{let{user:t}=e;return"podcasts:listening_progress:".concat(t.id)};a()(e=>{let{allProgress:t,user:i}=e,n=o({user:i});localStorage.setItem(n,JSON.stringify(t))},1e3)},30322:function(e,t,i){i(16584),i(30396),i(94184),i(86657),i(56219),i(19081),i(81043),i(14293),i(2689),i(9970),i(20888),i(95441),i(80878);var n=i(71068);i(15771),i(36500),i(38841),i(63474),i(58175),i(2009),i(5623),i(60308),i(63651),i(84864),(0,n.zo)({display:"flex",direction:"row",flex:"grow",alignItems:"center",justifyContent:"space-between",paddingX:8,gap:16}),i(44312)},44312:function(e,t,i){i.d(t,{G:()=>o}),i(16584);var n=i(98661),r=i(30396);i(59854),i(15850);let a=(0,n.createContext)({activePodcast:null,activePost:null,activePublication:null,lastActivePost:null,lastActivePodcast:null,lastActivePublication:null,audioPlayerRef:{current:null},currentTime:0,duration:null,isPlaying:!1,listeningProgress:{},onClear:()=>void 0,onPlay:()=>void 0,onToggle:()=>void 0}),o=()=>(0,r.qp)(a)},98905:function(e,t,i){i.d(t,{K:()=>p});var n=i(7409),r=i(99282),a=i(98848),o=i(16584),l=i(98661),s=i(94184),d=i.n(s),c=i(19081),u=i(37381);let p=(0,l.forwardRef)((e,t)=>{var{className:i,error:l=!1,type:s="text",width:p,background:h,font:v,leftIcon:Z,rightIcon:m}=e,f=(0,a._)(e,["className","error","type","width","background","font","leftIcon","rightIcon"]);let g=(0,o.tZ)("input",(0,r._)((0,n._)({},f),{className:d()(i,u.Z.inputWithIcons,{[u.Z.error]:l},v&&u.Z["font-".concat(v)]),style:{width:p,background:h},type:s,ref:t}));return(0,o.BX)(c.gq,{paddingX:12,className:d()(i,u.Z.inputWrapper,{[u.Z.error]:l}),style:{width:p,background:h},children:[Z&&(0,o.tZ)("span",{children:Z}),g,m&&(0,o.tZ)("span",{children:m})]})})}}]);