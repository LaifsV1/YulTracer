(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8523"],{33803:function(e,t,r){"use strict";r.d(t,{Z:()=>n});let n={elevatedTheme:"elevatedTheme-fBklGV"}},6114:function(e,t,r){"use strict";r.d(t,{Z:()=>n});let n=/^(1588|1691|4457)$/.test(r.j)?null:{menu:"menu-sPR2Yu",submenu:"submenu-kccqXE",floatingContainer:"floatingContainer-SiCBnk",menuItem:"menuItem-AADi97",disabled:"disabled-Q9za9D",priority_primary:"priority_primary-oAX5mN",priorityPrimary:"priority_primary-oAX5mN",priority_destructive:"priority_destructive-ayiS14",priorityDestructive:"priority_destructive-ayiS14",priority_secondary:"priority_secondary-A4gq_6",prioritySecondary:"priority_secondary-A4gq_6",relative:"relative-Qkdqwp",icon:"icon-HOkFAd",text:"text-DCgRW4",transition:"transition-lyUTv9",show:"show-yWHKyA",hide:"hide-Zl_8Aa",actionSheetTransition:"actionSheetTransition-FqigoZ",actionSheetShow:"actionSheetShow-D8Iizn",actionSheetHide:"actionSheetHide-Kzcnug"}},68857:function(e,t,r){"use strict";r.d(t,{Z:()=>n});let n=/^(2987|3154|3270|4716|5288|6909)$/.test(r.j)?{scrollBox:"scrollBox-zHkQVP",arrowButtonContainer:"arrowButtonContainer-O4uSiH",visible:"visible-JMTC0j",right:"right-i3oWGi",left:"left-Tg8vqp",arrowButtonOffsetContainer:"arrowButtonOffsetContainer-VMYLE4",arrowButtonOverlaidContainer:"arrowButtonOverlaidContainer-t10AyH",overlay:"overlay-zrMCxn",primary:"primary-lv_sOW",secondary:"secondary-pOosZC",arrowButtonOverlaid:"arrowButtonOverlaid-xLyA_z"}:null},82569:function(e,t,r){var n=r(20731),i=r(5976),o=r(29246),a=i(function(e,t){return o(e)?n(e,t):[]});e.exports=a},29032:function(e,t,r){"use strict";r.d(t,{C:()=>o});var n=r(16584),i=r(4615);let o=e=>{let{children:t,disable:r}=e;return r?(0,n.tZ)(n.HY,{children:t}):(0,n.tZ)(i.f6,{theme:"dark-theme",children:t})}},50012:function(e,t,r){"use strict";r.d(t,{C:()=>g,l:()=>b});var n=r(7409);if(/^(2[79]87|1612|3154|4153|4716|5288|6909)$/.test(r.j))var i=r(99282);var o=r(98848),a=r(16584),l=r(30396),s=r(94184),c=r.n(s),u=r(85685);if(/^(2[79]87|1612|3154|4153|4716|5288|6909)$/.test(r.j))var d=r(93252);var p=r(63018),f=r(32700),h=r(63651);if(/^(2[79]87|1612|3154|4153|4716|5288|6909)$/.test(r.j))var v=r(81821);var m=r(90271);function g(e){var{children:t,disabled:r}=e,l=(0,o._)(e,["children","disabled"]);return r||(0,v.tq)()||(0,d.P)()?(0,a.tZ)(a.HY,{children:t}):(0,a.tZ)(_,(0,i._)((0,n._)({},l),{children:t}))}function _(e){var t,r,s,c,d,{className:v,children:g,subject:_,placement:Z="right-center",utmSource:y}=e,w=(0,o._)(e,["className","children","subject","placement","utmSource"]);let[x,k]=(0,l.eJ)(!1),C=(t=null!==(d=null!==(c=_.slug)&&void 0!==c?c:_.handle)&&void 0!==d?d:(0,h._IO)(_),r={auto:x},(0,p._I)("/api/v1/user/".concat(t,"/public_profile"),r)),N=C.data,M=(0,f.o)((0,n._)({className:m.Z.profileHoverCard,loading:C.isLoading,hideOnScroll:!0,onOpen:()=>{k(!0)},layerOptions:{placement:Z},content:N?(0,a.tZ)(u.ProfileCard,{profile:N,subject:_,utmSource:y,forceRefresh:()=>C.mutate()}):null},w));return(0,a.BX)(b,(0,i._)((0,n._)({className:v},M.hoverProps),{forwardRef:null===(s=M.triggerProps)||void 0===s?void 0:s.ref,children:[g,M.layer]}))}function b(e){var{inline:t,className:r,forwardRef:i}=e,l=(0,o._)(e,["inline","className","forwardRef"]);return(0,a.tZ)("div",(0,n._)({className:c()("profile-hover-card-target",m.Z.profileHoverCardTarget,t&&m.Z.inline,r),ref:i},l))}},19548:function(e,t,r){"use strict";if(r.d(t,{CH:()=>w,Jv:()=>b,KG:()=>Z,Y_:()=>_,Yq:()=>C,fQ:()=>k,gc:()=>y}),/^(2[79]87|3154|4716|5288|6909)$/.test(r.j))var n=r(7409);if(/^(2[79]87|3154|4716|5288|6909)$/.test(r.j))var i=r(99282);var o=r(16584),a=r(6400),l=r(30396);if(/^(2[79]87|3154|4716|5288|6909)$/.test(r.j))var s=r(10844);if(/^(2[79]87|3154|4716|5288|6909)$/.test(r.j))var c=r(88812);var u=r(60807),d=r(48980),p=r(7882),f=r(98914),h=r(36500),v=r(70379);let m={mutes:[],blocks:[],blocked:[]},g=(0,a.createContext)({result:m,refetch:async()=>null,isBlockingUser:()=>!1,isMutedByUser:()=>!1,isBlockedByUser:()=>!1});function _(e){let{user:t,children:r}=e,n=(0,p.ib)({pathname:"/api/v1/blocks/ids",deps:[t],auto:!!t}),i=(0,l.Ye)(()=>{let{result:e,refetch:t}=n;if(e){let{blocked:r,mutes:n,blocks:i}=e,o=new Set(r),a=new Set(n),l=new Set(i);return{result:e,refetch:t,isBlockingUser:e=>o.has(e),isMutedByUser:e=>a.has(e),isBlockedByUser:e=>l.has(e)}}return{result:m,refetch:t,isBlockingUser:()=>!1,isMutedByUser:()=>!1,isBlockedByUser:()=>!1}},[n.result]);return(0,o.tZ)(g.Provider,{value:i,children:r})}function b(){return(0,l.qp)(g)}function Z(e){let{isBlockingUser:t,isBlockedByUser:r}=(0,l.qp)(g);return e?r(e)?"blocking":t(e)?"blocked":null:null}function y(e){let{isBlockingUser:t,isBlockedByUser:r,isMutedByUser:n}=(0,l.qp)(g);return e?n(e)?"muting":r(e)?"blocking":t(e)?"blocked":null:null}function w(e,t){let{surface:r,noteId:a,onClick:l}=t,p=(0,u.aF)(),m=!!(p&&e&&p.id!==e.id),g=b(),_=y(null==e?void 0:e.id),Z=(0,v.pm)(),w=async()=>{if(e){try{await (0,d.rd)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"mute",surface:r,noteId:a}})}catch(e){Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:(0,f.zx)(e)})));return}g.refetch(),Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:"".concat(e.name||"User"," muted"),Icon:s.Z}))),null==l||l("mute")}},x=async()=>{if(e){try{await (0,d.rd)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:r,noteId:a}})}catch(e){Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:(0,f.zx)(e)})));return}g.refetch(),Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:"".concat(e.name||"User"," unmuted"),Icon:s.Z}))),null==l||l("unmute")}},k=async()=>{if(e){try{await (0,d.rd)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"block",surface:r,noteId:a}})}catch(e){Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:(0,f.zx)(e)})));return}g.refetch(),Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:"".concat(e.name||"User"," blocked"),Icon:c.Z}))),null==l||l("block")}},C=async()=>{if(e){try{await (0,d.rd)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:r,noteId:a}})}catch(e){Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:(0,f.zx)(e)})));return}g.refetch(),Z.popToast(t=>(0,o.tZ)(v.FN,(0,i._)((0,n._)({},t),{text:"".concat(e.name||"User"," unblocked"),Icon:c.Z}))),null==l||l("unblock")}},N=[];return m&&("blocking"!==_&&N.push((0,o.tZ)(h.sN,{leading:(0,o.tZ)(s.Z,{}),priority:"destructive",onClick:"muting"===_?x:w,children:"muting"===_?"Unmute":"Mute"})),N.push((0,o.tZ)(h.sN,{leading:(0,o.tZ)(c.Z,{}),priority:"destructive",onClick:"blocking"===_?C:k,children:"blocking"===_?"Unblock":"Block"}))),N}g.displayName="UserBlockContext";let x=(0,a.createContext)(!1);function k(e){let{muteFree:t=!0,children:r}=e;return(0,o.tZ)(x.Provider,{value:t,children:r})}function C(){return(0,l.qp)(x)}x.displayName="MuteFreeZone"},35543:function(e,t,r){"use strict";r.d(t,{Sv:()=>L,Xe:()=>M,oJ:()=>B,oh:()=>j,yr:()=>P});var n=r(7409),i=r(99282),o=r(58865),a=r(16584),l=r(30396),s=r(82569),c=r.n(s),u=r(94734),d=r(17520),p=r(69241),f=r(19548),h=r(95441),v=r(60807),m=r(54371),g=r(6910),_=r(48980),b=r(63018),Z=r(98914),y=r(84747),w=r(70379),x=r(81043),k=r(23945);function C(){let e=(0,o._)(["Followed ",""]);return C=function(){return e},e}function N(){let e=(0,o._)(["Unfollowed ",""]);return N=function(){return e},e}function M(e){let t=(0,v.aF)();return(0,b._I)("/api/v1/feed/following",(0,n._)({auto:!!t},e))}function B(){let{mutate:e}=(0,p.kY)();return function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e("/api/v1/feed/following",...r)}}function j(e,t,r){let{isFollowing:n,toggle:i}=L(e,t,r),o=(0,v.aF)(),l=(0,f.gc)(null==e?void 0:e.id),s=!!(o&&e&&o.id!==e.id)&&!l,c=[];return s&&c.push((0,a.tZ)(y.u,{leading:n?(0,a.tZ)(g.m,{stroke:"var(--color-fg-primary)"}):(0,a.tZ)(m.w,{stroke:"var(--color-fg-primary)"}),onClick:i,children:n?"Unfollow":"Follow"})),c}function L(e,t,r,o){let l=(0,v.aF)(),{onboardingModalRef:s,requireLogin:p}=(0,x.SJ)(),f=function(e,t){let{data:r}=M(t);return(null!=r?r:[]).includes(null!=e?e:0)}(null==e?void 0:e.id,o),{mutate:m,data:g}=M(o),b=(0,w.pm)(),y=(0,k.Q1)((null==e?void 0:e.name)||""),{iString:B,iTemplate:j}=(0,h.M1)(),L=async o=>{if(e){if(!l&&s.current){p?p():s.current.open();return}m(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return o?[...t,e.id]:c()(t,e.id)},{revalidate:!1});try{await (0,_.rd)("/api/v1/feed/".concat(e.id,"/follow"),{method:o?"POST":"DELETE",json:{surface:t,noteId:r}}),b.popToast(e=>(0,a.tZ)(w.FN,(0,i._)((0,n._)({},e),{Icon:o?u.Z:d.Z,text:o?j(C(),y):j(N(),y),cta:B("Undo"),onAccept:()=>L(!o)})))}catch(e){b.popToast(t=>(0,a.tZ)(w.FN,(0,i._)((0,n._)({},t),{text:(0,Z.zx)(e)})));return}}};return{isFollowing:f,toggle:()=>L(!f),isLoaded:!!g}}function P(e,t,r){let{isFollowing:n,toggle:i}=L(e,t,r),[o,a]=(0,l.eJ)(!1);return{isFollowing:n,buttonProps:{onClick:()=>{i(),n||a(!0)},onMouseLeave:()=>a(!1)}}}},80143:function(e,t,r){"use strict";r.d(t,{Q:()=>l,Y:()=>s});var n=r(16584),i=r(98661),o=r(30396);let a=(0,i.createContext)({});function l(e){let{entityKey:t,children:r}=e;return(0,n.tZ)(a.Provider,{value:{entityKey:t},children:r})}function s(){return(0,o.qp)(a).entityKey}},6910:function(e,t,r){"use strict";r.d(t,{m:()=>l});var n=r(7409),i=r(99282),o=r(98848),a=r(16584);function l(e){var{size:t=20,stroke:r="var(--color-light-fg-secondary)"}=e,l=(0,o._)(e,["size","stroke"]);return(0,a.tZ)("svg",(0,i._)((0,n._)({},l),{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:r,xmlns:"http://www.w3.org/2000/svg",children:(0,a.tZ)("path",{id:"Vector",d:"M3 22C3 17.7044 6.69722 14.2222 11.258 14.2222C11.5081 14.2222 11.7556 14.2326 12 14.2531M21.0039 16.3098L18.6469 18.6668M18.6469 18.6668L16.2899 21.0239M18.6469 18.6668L21.0178 21.0377M18.6469 18.6668L16.276 16.2959M16.4118 6.44444C16.4118 8.89904 14.4102 10.8889 11.9412 10.8889C9.47214 10.8889 7.47059 8.89904 7.47059 6.44444C7.47059 3.98985 9.47214 2 11.9412 2C14.4102 2 16.4118 3.98985 16.4118 6.44444Z",strokeWidth:"2",strokeLinecap:"round","stroke-linejoin":"round"})}))}},83786:function(e,t,r){"use strict";r.d(t,{M:()=>o});var n=r(98661);let i=0;function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,n.useMemo)(()=>(i=++i>Number.MAX_SAFE_INTEGER?1:i,"".concat(e).concat(i)),t)}},73410:function(e,t,r){"use strict";r.d(t,{V:()=>i});var n=r(98661);let i=/^(4716|5288)$/.test(r.j)?(0,n.createContext)("preact-router"):null},9682:function(e,t,r){"use strict";r.d(t,{bA:()=>c,js:()=>l,tv:()=>s,yj:()=>u});var n=r(30396),i=r(20042);if(/^(4716|5288)$/.test(r.j))var o=r(74856);var a=r(73410);function l(e,t){(0,n.d4)(()=>{let t=t=>{e(t)};return i.subscribers.push(t),()=>{i.subscribers.splice(i.subscribers.indexOf(t)>>>0,1)}},t)}function s(){let{path:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,n.eJ)({}),o=(0,n.sO)(null);l(e=>{o.current=e,r({})},[]);let a=o.current||(0,i.getCurrentUrl)(),s=a.replace(/\?.+$/,""),c=document.location.hash;return o.current=null,[{url:a,path:s,matches:e&&(0,i.exec)(s,e,{})||null,hash:c},i.route]}function c(){return history.state}function u(){if("react-router"===(0,n.qp)(a.V)){let e=(0,o.s0)();return(t,r)=>(e(t,{replace:r}),!0)}return i.route}},63018:function(e,t,r){"use strict";r.d(t,{OV:()=>s,_I:()=>l,kp:()=>a.kp});var n=r(7409),i=r(98848),o=r(69241),a=r(48980);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;var{deps:l,auto:s=!0,massage:c=async e=>e,shouldRevalidate:u=!0}=t,d=(0,i._)(t,["deps","auto","massage","shouldRevalidate"]);return(0,o.ZP)(s?l?[...l,e]:e:null,()=>(0,a.rd)(e,d).then(c),(0,n._)({},u?null:{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1},r))}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var{deps:r}=t,n=(0,i._)(t,["deps"]);(0,o.MA)(r?[...r,e]:e,()=>(0,a.rd)(e,n))}},60684:function(e,t,r){"use strict";r.d(t,{V:()=>v});var n=r(16584);if(!/^(1588|1691|4457)$/.test(r.j))var i=r(19425);var o=r(94184),a=r.n(o);if(!/^(1588|1691|4457)$/.test(r.j))var l=r(71375);var s=r(98661),c=r(20160),u=r(15771),d=r(80026),p=r(19081),f=r(58175);let h=/^(1588|1691|4457)$/.test(r.j)?null:{root:"root-BnqjqA",sheet:"sheet-dvfhcO",transition:"transition-yWeLc7",show:"show-xTDs8w",hide:"hide-F0u6Dg"},v=/^(1588|1691|4457)$/.test(r.j)?null:(0,s.forwardRef)((e,t)=>{let{title:r,onClose:o,children:s,className:v,paddingY:m=8}=e;return(0,n.tZ)(p.tu,{className:h.root,onClick:o,children:(0,n.tZ)(i.u.Child,{appear:!0,className:h.transition,enterFrom:h.hide,enterTo:h.show,leaveFrom:h.show,leaveTo:h.hide,children:(0,n.tZ)(c.W,{children:(0,n.BX)(p.tu,{className:a()(h.sheet,v),padding:8,ref:t,onClick:e=>{e.stopPropagation()},children:[!!r&&(0,n.BX)(n.HY,{children:[(0,n.BX)(p.hs,{justifyContent:"space-between",alignItems:"center",paddingX:8,paddingTop:8,paddingBottom:16,children:[(0,n.tZ)(p.tu,{gap:4,justifyContent:"center",children:(0,n.tZ)(f.xv.B3,{weight:"semibold",children:r})}),(0,n.tZ)(u.hU,{priority:"tertiary",onClick:()=>{o()},children:(0,n.tZ)(l.Z,{size:20})})]}),(0,n.tZ)(d.iz,{paddingX:8})]}),(0,n.tZ)(p.tu,{gap:8,paddingY:m,overflowY:"auto",children:s})]})})})})})},2629:function(e,t,r){"use strict";if(r.d(t,{v:()=>m}),!/^(1588|1691|2536|4457)$/.test(r.j))var n=r(7409);if(!/^(1588|1691|2536|4457)$/.test(r.j))var i=r(99282);var o=r(16584);if(!/^(1588|1691|2536|4457)$/.test(r.j))var a=r(78493);if(!/^(1588|1691|2536|4457)$/.test(r.j))var l=r(28518);if(!/^(1588|1691|2536|4457)$/.test(r.j))var s=r(93920);if(!/^(1588|1691|2536|4457)$/.test(r.j))var c=r(55585);var u=r(98661),d=r(71068);if(!/^(1588|1691|2536|4457)$/.test(r.j))var p=r(58076);var f=r(14775),h=r(6114);let v=/^(1588|1691|2536|4457)$/.test(r.j)?null:{padding:0,elementContext:"floating",altBoundary:!1,rootBoundary:"viewport"};function m(e){let{trigger:t,children:r,onOpen:n,onClose:i,disabled:a,stopPropagation:l,placement:s="bottom",matchReferenceWidth:u=!1}=e;return(0,o.tZ)(c.v,{children:e=>{let{open:c}=e;return(0,o.tZ)(g,{trigger:t,children:r,open:c,onOpen:n,onClose:i,disabled:a,stopPropagation:l,placement:s,matchReferenceWidth:u})}})}function g(e){let{trigger:t,children:r,open:m,disabled:g,onOpen:_,onClose:b,stopPropagation:Z,placement:y,matchReferenceWidth:w}=e,x=[(0,a.cv)(4),(0,a.RR)()];w&&x.push((0,a.dp)((0,i._)((0,n._)({},v),{apply(e){let{rects:t,elements:r}=e;Object.assign(r.floating.style,{minWidth:"".concat(t.reference.width,"px")})}})));let{refs:k,floatingStyles:C,context:N}=(0,l.YF)({placement:y,strategy:"fixed",open:m,whileElementsMounted:s.Me,middleware:x}),{getReferenceProps:M,getFloatingProps:B}=(0,l.NI)([(0,l.bQ)(N,{ancestorScroll:!0})]),{isMounted:j,styles:L}=(0,l.Y_)(N,{duration:250,initial:e=>{let{side:t}=e;return{opacity:0,transform:"translate".concat("bottom"===t||"top"===t?"Y":"X","(calc(").concat("bottom"===t||"right"===t?-1:1," * ").concat("var(--size-8)","))")}},open:{opacity:1,transform:"translate(0, 0)"},common:{transition:"var(--animate-hover)"}});return(0,u.useEffect)(()=>{m?null==_||_():null==b||b()},[m]),(0,o.BX)(d.xu,{onClick:e=>{Z&&e.stopPropagation()},display:"contents",children:[(0,o.tZ)(c.v.Button,(0,i._)((0,n._)({as:u.Fragment,ref:k.setReference},M()),{disabled:g,children:t})),(0,o.tZ)(l.ll,{children:j&&(0,o.tZ)(c.v.Items,(0,i._)((0,n._)({className:h.Z.floatingContainer,ref:k.setFloating,style:(0,i._)((0,n._)({},C),{zIndex:p.nx}),static:!0},B()),{children:(0,o.tZ)(f.F,{style:L,children:r})}))})]})}},14775:function(e,t,r){"use strict";if(r.d(t,{F:()=>p}),!/^(1588|1691|4457)$/.test(r.j))var n=r(7409);if(!/^(1588|1691|4457)$/.test(r.j))var i=r(98848);var o=r(16584),a=r(94184),l=r.n(a),s=r(98661),c=r(19081),u=r(4615),d=r(6114);let p=/^(1588|1691|4457)$/.test(r.j)?null:(0,s.forwardRef)((e,t)=>{var{className:r,padding:a=4}=e,s=(0,i._)(e,["className","padding"]);return(0,o.tZ)(u.Sf,{children:(0,o.tZ)(c.tu,(0,n._)({className:l()(d.Z.menu,"elevated",r),bg:"elevated",shadow:"md",border:"detail",radius:"sm",sizing:"border-box",showFocus:!0,gap:2,padding:a,ref:t},s))})})},51799:function(e,t,r){"use strict";r.d(t,{d:()=>l});var n=r(16584),i=r(19081),o=r(36500),a=r(58175);function l(e){let{children:t}=e;return(0,n.tZ)(o.xw,{children:(0,n.tZ)(i.tu,{paddingY:4,paddingX:8,children:(0,n.tZ)(a.xv.B5,{color:"secondary",children:t})})})}},39198:function(e,t,r){"use strict";r.d(t,{t:()=>l});var n=r(16584),i=r(61254),o=r(19081),a=r(58175);function l(e){let{children:t}=e;return(0,n.BX)(n.HY,{children:[(0,n.tZ)(o.tu,{paddingY:4,paddingX:8,children:(0,n.tZ)(a.xv.B4,{color:"secondary",children:t})}),(0,n.tZ)(i.iz,{pullX:8})]})}},14651:function(e,t,r){"use strict";if(r.d(t,{$Z:()=>_,$j:()=>b,Mz:()=>Z,sN:()=>v,tV:()=>m,tc:()=>g}),!/^(1588|1691|4457)$/.test(r.j))var n=r(7409);if(!/^(1588|1691|4457)$/.test(r.j))var i=r(99282);if(!/^(1588|1691|4457)$/.test(r.j))var o=r(98848);var a=r(16584);if(!/^(1588|1691|2536|4457)$/.test(r.j))var l=r(55585);var s=r(98661),c=r(71068),u=r(15771),d=r(47295),p=r(50368),f=r(84747),h=r(58175);function v(e){return(0,a.tZ)(l.v.Item,{children:(0,a.tZ)(f.u,(0,n._)({},e))})}let m=/^(1588|1691|4457)$/.test(r.j)?null:(0,s.forwardRef)((e,t)=>{var{children:r,onClick:l,closeMenu:c,leading:f,trailing:h,priority:v="primary",className:m,disabled:_,href:b,download:y,hiddenInput:w}=e,x=(0,o._)(e,["children","onClick","closeMenu","leading","trailing","priority","className","disabled","href","download","hiddenInput"]);let k=b?"a":u.kG,{close:C}=(0,p.X)();return(0,a.BX)(k,(0,i._)((0,n._)({className:m,resetCss:!0,onClick:e=>{!_&&(l&&l(e),!e.defaultPrevented&&(C?C():c&&c()))},href:_?"javascript:void(0)":b,download:y,ref:t},x),{children:[f&&(0,a.tZ)(Z,{children:(0,s.cloneElement)(f,{size:16})}),(0,a.tZ)(g,{priority:v,children:r}),h&&(0,a.tZ)(Z,{children:(0,s.cloneElement)(h,{size:16})}),w&&(0,a.tZ)(d.U,{children:w})]}))});function g(e){let{priority:t,children:r}=e;return(0,a.tZ)(h.xv.B4,{color:"destructive"===t?"error":"accent"===t?"accent":t,weight:"medium",align:"left",flex:"grow",children:r})}function _(e){let{children:t}=e;return(0,a.tZ)(h.xv.B5,{color:"secondary",align:"left",children:t})}let b=(0,c.zo)({width:16,height:16}),Z=(0,c.zo)({display:"flex",flex:"auto",width:24,height:24,alignItems:"center",justifyContent:"center"})},88326:function(e,t,r){"use strict";r.d(t,{x:()=>l});var n=r(16584),i=r(61254),o=r(19081),a=r(58175);function l(e){let{title:t,children:r,isFirst:a=!1}=e;return(0,n.BX)(o.tu,{gap:2,children:[!a&&(0,n.tZ)(i.iz,{paddingY:4,pullX:4}),t&&(0,n.tZ)(s,{children:t}),r]})}function s(e){let{children:t}=e;return(0,n.tZ)(a.xv.B5,{color:"secondary",weight:"regular",paddingX:4,paddingTop:4,children:t})}},87077:function(e,t,r){"use strict";r.d(t,{$$:()=>y,k9:()=>w,u:()=>x});var n=r(7409),i=r(99282),o=r(98848),a=r(16584),l=r(19425),s=r(94184),c=r.n(s),u=r(98661),d=r(62372),p=r(29032),f=r(20888),h=r(71068),v=r(58076),m=r(19081),g=r(58175),_=r(165);let b=["top-start","top-center","top-end","bottom-start","bottom-center","bottom-end"],Z=["left-start","left-center","left-end","right-start","right-center","right-end"],y=500,w=2987==r.j?{size:16,color:"var(--color-utility-white)"}:null,x=e=>{var{children:t,text:r,title:l,imageUrl:s,as:p="span",leading:f,trailing:h,preferPlacement:m="top-center",layerOptions:g,disabled:y,hoverOptions:w={},toggleOptions:x}=e,C=(0,o._)(e,["children","text","title","imageUrl","as","leading","trailing","preferPlacement","layerOptions","disabled","hoverOptions","toggleOptions"]);let{layerProps:N,triggerProps:M,hoverProps:B,transitionProps:j,renderLayer:L,shouldShow:P}=function(){var e;let{hoverOptions:t,layerOptions:r,toggleOptions:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[o,a]=(0,u.useState)(!1),[l,s]=(0,d.XI)((0,n._)({},t)),p=i?i.show:l,{triggerProps:f,layerProps:h,renderLayer:v}=(0,d.sJ)((0,n._)({isOpen:p,auto:!0,triggerOffset:8},r)),m=null!==(e=null==r?void 0:r.placement)&&void 0!==e?e:"top-center",g="",b="";switch(m){case"top-start":case"top-center":case"top-end":default:g=c()(_.Z.hide,_.Z.fromBelow),b=c()(_.Z.hide,_.Z.fromBelow);break;case"bottom-start":case"bottom-center":case"bottom-end":g=c()(_.Z.hide,_.Z.fromAbove),b=c()(_.Z.hide,_.Z.fromAbove);break;case"left-start":case"left-center":case"left-end":g=c()(_.Z.hide,_.Z.fromRight),b=c()(_.Z.hide,_.Z.fromRight);break;case"right-start":case"right-center":case"right-end":g=c()(_.Z.hide,_.Z.fromLeft),b=c()(_.Z.hide,_.Z.fromLeft)}return{layerProps:h,triggerProps:f,hoverProps:s,transitionProps:{show:p,beforeEnter:()=>a(!0),afterLeave:()=>a(!1),enterFrom:g,leaveTo:b},renderLayer:v,shouldShow:p||o}}({layerOptions:(0,n._)({placement:m,possiblePlacements:Z.includes(m)?Z:b},g),hoverOptions:(0,n._)({delayLeave:50},w),toggleOptions:x}),{style:S}=N,$=(0,o._)(N,["style"]);return y?(0,a.tZ)(a.HY,{children:t}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(p,(0,i._)((0,n._)({},M,B,C),{children:t})),P&&L((0,a.tZ)(k,{transitionProps:j,tooltipProps:(0,i._)((0,n._)({},$,B),{style:(0,i._)((0,n._)({},S),{maxWidth:320,zIndex:v.PU})}),text:r,title:l,imageUrl:s,leading:f,trailing:h}))]})};function k(e){let{transitionProps:t,tooltipProps:r,leading:o,trailing:l,text:s,title:c,imageUrl:d}=e,h=s&&!c&&!d;return(0,a.tZ)("div",(0,i._)((0,n._)({},r),{children:(0,a.tZ)(L,(0,i._)((0,n._)({},t),{children:(0,a.tZ)(p.C,{children:(0,a.BX)(j,{textOnly:h,children:[d&&(0,a.tZ)(B,{children:(0,a.tZ)(f.e,{src:d,maxWidth:296,useRetinaSizing:!0,imageIsFixedWidth:!0})}),(0,a.BX)(M,{hasTitle:!!c,children:[o&&(0,a.tZ)(N,{children:o}),(0,a.BX)(C,{children:[c&&(0,a.tZ)(g.xv.B4,{weight:"medium",color:"primary",className:_.Z.title,children:c}),(0,a.tZ)(g.xv.B4,{color:"primary",opacity:80,lineHeight:16,children:"string"==typeof s?s.split("\n").map((e,t)=>(0,a.BX)(u.Fragment,{children:[t>0&&(0,a.tZ)("br",{}),e]},t)):s})]}),l&&(0,a.tZ)(N,{children:l})]})]})})}))}))}let C=(0,h.zo)({display:"flex",direction:"column",gap:2});function N(e){let{children:t}=e;return(0,a.tZ)(m.X2,{alignItems:"center",justifyContent:"center",className:_.Z.endcapContainer,flex:"auto",gap:8,children:t})}function M(e){let{hasTitle:t,children:r}=e;return(0,a.tZ)(m.X2,{alignItems:t?"start":"center",gap:8,children:r})}function B(e){let{children:t}=e;return(0,a.tZ)(m.sg,{border:"detail",radius:"sm",className:_.Z.imageContainer,overflow:"hidden",children:t})}function j(e){let{textOnly:t,children:r}=e;return(0,a.tZ)(m.sg,{alignItems:"center",paddingY:t?6:12,paddingX:t?8:12,gap:8,radius:"md",shadow:"md",border:"detail",bg:"secondary",children:r})}function L(e){return(0,a.tZ)(l.u,(0,n._)({appear:!0,unmount:!1,className:_.Z.animate,enterTo:_.Z.show,leaveFrom:_.Z.show},e))}},47295:function(e,t,r){"use strict";r.d(t,{U:()=>o});var n=r(16584);r(98661);let i=/^(1588|1691|4457)$/.test(r.j)?null:{hiddenInput:"hiddenInput-m9n617"},o=e=>{let{children:t}=e;return(0,n.tZ)("div",{className:i.hiddenInput,children:t})}},50368:function(e,t,r){"use strict";r.d(t,{X:()=>o,p:()=>i});var n=r(98661);let i=/^(1588|1691|4457)$/.test(r.j)?null:(0,n.createContext)({useMobileBottomSheet:!0,close:()=>void 0});function o(){return(0,n.useContext)(i)}},10903:function(e,t,r){"use strict";if(r.d(t,{x:()=>s}),!/^(1588|1691|4457)$/.test(r.j))var n=r(7409);if(!/^(1588|1691|4457)$/.test(r.j))var i=r(99282);var o=r(98661);if(!/^(1588|1691|4457)$/.test(r.j))var a=r(62372);var l=r(83786);let s=function(){let{layerOptions:e,hideOnScroll:t,onClose:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[s,c]=(0,o.useState)(!1),{triggerProps:u,layerProps:d,renderLayer:p}=(0,a.sJ)((0,n._)({isOpen:s,placement:"bottom-center",preferY:"bottom",triggerOffset:10,onOutsideClick:()=>{r&&r(),c(!1)}},e)),f=(0,l.M)("trigger"),h=(0,l.M)("dialog");return(0,o.useEffect)(()=>{if(t){let e=()=>{requestAnimationFrame(()=>{open&&t&&c(!1)})};return window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("scroll",e,!0)}}},[t]),{triggerProps:(0,i._)((0,n._)({},u),{id:f,"aria-expanded":s,"aria-haspopup":"dialog","aria-controls":h}),layerProps:(0,i._)((0,n._)({},d),{id:h,role:"dialog",tabIndex:0,"aria-labeledby":f}),renderLayer:p,isOpen:s,setOpen:c}}},45783:function(e,t,r){"use strict";if(r.d(t,{De:()=>v,R3:()=>b,eK:()=>h,nD:()=>g,rQ:()=>m}),!/^(1588|1691|2536|4457)$/.test(r.j))var n=r(7409);if(!/^(1588|1691|2536|4457)$/.test(r.j))var i=r(99282);if(/^(2987|3270)$/.test(r.j))var o=r(98848);var a=r(16584),l=r(94184),s=r.n(l);if(/^(2987|3154|4716|5288|6909)$/.test(r.j))var c=r(56743);if(/^(2987|3154|4716|5288|6909)$/.test(r.j))var u=r(2564);var d=r(98661),p=r(80026),f=r(68857);let h=function(e){let{inset:t=0,pageSizeAdjust:r=0,initialState:o,scrollFullPage:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[l,s]=(0,d.useState)(o||{showLeft:!1,showRight:!1});return(0,d.useEffect)(()=>{let{current:r}=e;if(r){let e=()=>{s(e=>{let o=e;!o.showLeft&&r.scrollLeft>t?o=(0,i._)((0,n._)({},e),{showLeft:!0}):o.showLeft&&r.scrollLeft<=t&&(o=(0,i._)((0,n._)({},e),{showLeft:!1}));let a=r.scrollWidth-r.offsetWidth-4-t;return!o.showRight&&r.scrollLeft<a?o=(0,i._)((0,n._)({},e),{showRight:!0}):o.showRight&&r.scrollLeft>=a&&(o=(0,i._)((0,n._)({},e),{showRight:!1})),o})};return r.addEventListener("scroll",e),setTimeout(()=>{e()},50),()=>{r.removeEventListener("scroll",e)}}},[]),{state:l,handleArrowClick:t=>()=>{let{current:n}=e;n&&n.scrollBy({left:t*(a?n.offsetWidth:n.offsetWidth/2-r),behavior:"smooth"})}}};function v(e){var{className:t,scrollRef:r}=e,l=(0,o._)(e,["className","scrollRef"]);return(0,a.tZ)(p.hs,(0,i._)((0,n._)({},l),{className:s()(f.Z.scrollBox,t),ref:r,overflowX:"auto",scrollBar:"hidden",minWidth:0,onTouchStart:e=>{let{pageX:t}=e;void 0!==t&&(!(t>10)||!(t<window.innerWidth-10))&&e.preventDefault()}}))}function m(e){let{direction:t,isVisible:r=!0,onClick:n}=e;return(0,a.tZ)(p.hs,{alignItems:"center",justifyContent:"center",position:"absolute",className:s()(f.Z.arrowButtonContainer,f.Z.arrowButtonOffsetContainer,r&&f.Z.visible,f.Z[t]),children:(0,a.tZ)(_,{direction:t,isVisible:r,onClick:n})})}function g(e){let{direction:t,isVisible:r=!0,onClick:n}=e;return(0,a.tZ)(b,{direction:t,isVisible:r,children:(0,a.tZ)(_,{direction:t,isVisible:r,onClick:n,className:f.Z.arrowButtonOverlaid})})}function _(e){let{direction:t,isVisible:r=!0,onClick:n,className:i}=e;return(0,a.tZ)(p.hU,{size:"sm",priority:"quaternary",disabled:!r,className:i,onClick:n,"aria-hidden":!r,"aria-label":r?"left"===t?"Previous":"Next":void 0,children:"left"===t?(0,a.tZ)(c.Z,{}):(0,a.tZ)(u.Z,{})})}function b(e){let{direction:t,isVisible:r=!0,children:n,bg:i="primary"}=e;return(0,a.BX)(p.hs,{alignItems:"center",className:s()(f.Z.arrowButtonContainer,f.Z.arrowButtonOverlaidContainer,r&&f.Z.visible,f.Z[t]),children:[(0,a.tZ)("div",{className:s()(f.Z.overlay,f.Z[i])}),n]})}},76566:function(e,t,r){"use strict";r.d(t,{S:()=>d,m:()=>f});var n=r(27412),i=r(16584),o=r(20042),a=r(98661),l=r(20888),s=r(9682),c=r(19081),u=r(58175);class d extends a.Component{static getDerivedStateFromError(e){return{error:e}}componentDidMount(){Promise.all([r.e("7152"),r.e("6993")]).then(r.bind(r,91985)).then(e=>{this.Sentry=e.Sentry})}componentDidCatch(e){console.error(e),this.Sentry&&this.Sentry.captureException(e)}render(){let{error:e}=this.state;return(0,i.tZ)(p,{onReset:()=>this.setState({error:null}),error:e,children:e?(0,i.tZ)(f,{}):this.props.children})}constructor(e){super(e),(0,n._)(this,"Sentry",null),this.state={error:null}}}function p(e){let{onReset:t,error:r,children:n}=e,l=(0,a.useRef)((0,o.getCurrentUrl)());return(0,s.js)(e=>{r&&l.current!==e&&t(),l.current=e},[]),r?(0,i.tZ)(f,{}):n}function f(){return(0,i.BX)(c.tu,{flex:"grow",justifyContent:"center",alignItems:"center",gap:32,padding:20,children:[(0,i.tZ)(l.e,{src:"/img/reader/toad.png",maxWidth:200}),(0,i.BX)(c.tu,{gap:8,children:[(0,i.tZ)(u.xv.H3,{weight:"semibold",align:"center",children:"Oh noâ€”this page croaked."}),(0,i.tZ)(u.xv.B3,{color:"secondary",align:"center",children:"Try again, or hop to another page."})]})]})}},65575:function(e,t,r){"use strict";r.d(t,{$l:()=>O,CQ:()=>F,ET:()=>W,EU:()=>J,Ex:()=>U,Hd:()=>D,Hn:()=>S,II:()=>I,NP:()=>C,NZ:()=>N,P2:()=>A,QE:()=>V,SC:()=>Y,T3:()=>P,Uj:()=>M,V1:()=>k,Vm:()=>x.V,Wo:()=>T,Xq:()=>H,YE:()=>X,Z0:()=>Q,eK:()=>v.eK,fG:()=>B,gq:()=>f.gq,mE:()=>q,nv:()=>j,nw:()=>$,ox:()=>L,pe:()=>E,t5:()=>w.t,tu:()=>f.tu,xV:()=>z,zr:()=>G});var n=r(7409),i=r(99282),o=r(98848),a=r(16584),l=r(98661),s=r(94184),c=r.n(s),u=r(1852),d=r(80878),p=r(98914),f=r(19081),h=r(58175),v=r(45783),m=r(66611),g=r(76566),_=r(91400),b=r(63651),Z=r(47929),y=r(28840),w=r(38202),x=r(36889);function k(e){let{children:t}=e,r=(0,_.XA)();return(0,a.tZ)(R,{children:r?(0,a.tZ)(h.xv.H2,{children:t}):(0,a.tZ)(h.xv.H1,{children:t})})}function C(e){let{className:t,children:r,title:n,hasTitle:i}=e;return(0,a.BX)("div",{className:c()("reader2-page-section",(n||i)&&"withTitle",t),children:[n&&(0,a.tZ)(N,{children:n}),r]})}function N(e){let{children:t,className:r,actions:n}=e;return(0,a.BX)("div",{className:c()("reader2-section-title",r),children:[(0,a.tZ)("span",{className:"reader2-text-h3 reader2-section-title",children:t}),n&&(0,a.tZ)("div",{className:"reader2-header-actions",children:n})]})}let M=(0,l.forwardRef)((e,t)=>{var{isPadded:r=!0,className:l,linkClassName:s}=e,u=(0,o._)(e,["isPadded","className","linkClassName"]);return(0,a.tZ)("div",{ref:t,className:c()(y.Z.linkRow,r&&y.Z.isPadded,l),children:(0,a.tZ)(B,(0,i._)((0,n._)({},u),{className:s}))})});function B(e){var{children:t,className:r,href:l,newTab:s,onClick:u,noAnchor:p,native:h,utmCampaign:v,utmSource:m,isSelected:g}=e,_=(0,o._)(e,["children","className","href","newTab","onClick","noAnchor","native","utmCampaign","utmSource","isSelected"]);let w="undefined"!=typeof location?location.pathname:"",x=p||null==l?"div":"a",k=l&&(0,b.n1t)(l,{utm_source:m||w,utm_medium:Z.lP.reader2,utm_campaign:v});return(0,a.tZ)(f.hs,(0,i._)((0,n._)({as:x,className:c()(y.Z.linkRowA,r,(k||u)&&null==g&&y.Z.isClickable,g&&y.Z.isSelected,null!=g&&y.Z.isSelectable),"data-selected":g,href:k,target:s?"_blank":void 0,onClick:e=>{u&&u(e),!e.defaultPrevented&&p&&k&&(0,d.Q)(e,k,{native:h,newTab:s})},showFocus:!0,animate:!0},_),{children:t}))}function j(e){var{className:t,variant:r,size:i,serif:l,isConstrained:s,maxLines:u=3}=e,d=(0,o._)(e,["className","variant","size","serif","isConstrained","maxLines"]);return(0,a.tZ)("div",(0,n._)({className:c()("reader2-paragraph",r&&"reader2-".concat(r),i&&"reader2-font-".concat(i),l&&"reader2-font-serif",s&&"reader2-clamp-lines reader2-".concat(u,"-lines"),t)},d))}function L(e){let{className:t,children:r}=e;return(0,a.tZ)("div",{className:c()("reader-nav-center",t),children:(0,a.tZ)("div",{className:"reader2-page reader2-font-base",children:r})})}function P(e){let{className:t,scrollRef:r,children:n}=e;return(0,a.tZ)(T,{ref:r,children:(0,a.tZ)(L,{className:t,children:n})})}function S(e){var{scrollRef:t}=e,r=(0,o._)(e,["scrollRef"]);return(0,a.tZ)(T,{ref:t,children:(0,a.tZ)(f.hs,(0,i._)((0,n._)({},r),{flex:"grow",paddingX:{mobile:0,desktop:20},minWidth:0}))})}function $(e){return(0,u.useMediaQuery)({minWidth:1100})?(0,a.tZ)(f.tu,(0,n._)({className:"reader2-inbox-sidebar",paddingTop:20},e)):null}function O(e){return(0,a.tZ)(f.hs,(0,n._)({alignItems:"center",justifyContent:"space-between",paddingX:8},e))}function U(e){return(0,a.tZ)(f.tu,(0,n._)({gap:8},e))}let T=(0,l.forwardRef)((e,t)=>(0,a.tZ)(g.S,{children:(0,a.tZ)("div",(0,n._)({id:"reader-nav-page-scroll",className:c()("reader-nav-page-scroll",e.className),ref:t},e))})),I=(0,l.forwardRef)((e,t)=>{var{className:r,hasError:l}=e,s=(0,o._)(e,["className","hasError"]);return(0,a.tZ)("input",(0,i._)((0,n._)({className:c()(y.Z.input,l&&y.Z.error,r)},s),{ref:t}))});function F(e){let{error:t}=e;return(0,a.tZ)(H,{children:(0,p.zx)(t)})}function X(e){let{children:t}=e;return(0,a.tZ)(f.tu,{className:"reader2-inbox-sidebar-fixed",children:t})}function E(e){var{gap:t=16}=e,r=(0,o._)(e,["gap"]);return(0,a.tZ)(f.tu,(0,i._)((0,n._)({},r),{className:c()(y.Z.pageStack,y.Z["gap_".concat(t)])}))}let R=(0,m.L)("reader2-page-top");(0,m.L)(y.Z.pageTopFixed);let z=(0,m.L)("reader2-page-body"),q=(0,m.L)(y.Z.pageStack),W=(0,m.L)("reader2-page-center");(0,m.L)("reader2-modal-title-text"),(0,m.L)("reader2-column");let D=(0,m.L)("reader2-text-h3 reader2-section-title"),A=(0,m.L)("reader2-text-h4");(0,m.L)("reader2-item-title");let Y=(0,m.L)("reader2-item-meta"),H=(0,m.L)("reader2-form-error"),V=(0,m.L)("reader2-subtitle"),Q=(0,m.L)("reader2-separator","hr");(0,m.L)("reader2-page-section withTitle"),(0,m.L)("reader2-row reader2-split-row");let J=(0,m.L)(c()(y.Z.hoverLink,"pencraft"),"a");function G(e){return(0,a.tZ)(J,(0,n._)({target:"_blank"},e))}},97842:function(e,t,r){"use strict";r.d(t,{I0:()=>s,RN:()=>u,UX:()=>a,WG:()=>d,ge:()=>l,ky:()=>c});var n=r(6400),i=r(30396),o=r(63018);let a={user:null,inbox:{threadList:[],threads:new Map,filter:"all",resources:{all:{isLoading:!0,hasMore:!1},people:{isLoading:!0,hasMore:!1}}},users:new Map,profiles:new Map,communityPosts:new Map,communityComments:new Map,chats:new Map,comments:new Map,replies:new Map,conversations:new Map,publications:new Map,notes:new Map,editingPost:null},l=(0,n.createContext)(()=>Promise.resolve());function s(){return(0,i.qp)(l)}let c=(0,n.createContext)(a);function u(){return(0,i.qp)(c)}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,o._I)("/api/v1/messages/unread-count",e,t)}},65958:function(e,t,r){"use strict";r.d(t,{s:()=>h,z:()=>v});var n=r(7409),i=r(99282),o=r(16584),a=r(48980),l=r(80878),s=r(7882),c=r(70379),u=r(97842),d=r(95551),p=r(62515),f=r(36186);function h(e){let{source:t}=e,r=v({source:t}),s=(0,d.d)(),u=(0,c.pm)(),h=async e=>{var t;let d=await r.handleStart(e);return d instanceof Error?(d instanceof a.kp&&(null===(t=d.body)||void 0===t?void 0:t.type)==="profile_not_set_up"?u.popToast(e=>(0,o.tZ)(c.FN,(0,i._)((0,n._)({},e),{text:"Please set up your profile before sending a message.",cta:"Set up profile",href:(0,f.Nh)({utm_source:"substack",utm_campaign:"chat_dm_button",redirect:window.location}),localNavigation:!1}))):s(d,"Could not start conversation."),!1):((0,l._)((0,p.Rm)(d.thread.id)),!0)};return(0,i._)((0,n._)({},r),{handleStart:h})}function v(e){let{source:t}=e,r=(0,u.I0)(),o=(0,s.ib)({pathname:"/api/v1/messages/dm/start",method:"POST"}),a=async e=>{let n=await o.refetch({json:{user_ids:e,source:t}});return n instanceof Error||r({type:"conversation-load_more",payload:{edge:"before",cursor:null,page:n}}),n};return(0,i._)((0,n._)({},o),{handleStart:a})}},81043:function(e,t,r){"use strict";r.d(t,{Ly:()=>o,SJ:()=>l,qr:()=>a});var n=r(6400),i=r(30396);let o=(0,n.createContext)({setChildOptions:()=>{},onboardingModalRef:{current:null},isLoading:!1,subscriptions:[],publicationUsers:[],onPageScroll:()=>void 0,setPinTitle:()=>void 0,setDrawer:()=>null,checkFocus:()=>!1,requireLogin:null});function a(e){let{shouldShowGetAppPill:t=!0,style:r,alwaysPinTitle:n,backAction:o,onRefresh:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=l();return(0,i.bt)(()=>{var i;null===(i=s.setChildOptions)||void 0===i||i.call(s,{title:e,style:r,alwaysPinTitle:n,backAction:o,shouldShowGetAppPill:t,onRefresh:a})},[s,e,r,o,t,a]),(0,i.bt)(()=>{var e;null===(e=s.setPinTitle)||void 0===e||e.call(s,!1)},[]),s}function l(){return(0,i.qp)(o)}},32189:function(e,t,r){"use strict";r.d(t,{i:()=>s,x:()=>l});var n=r(30396),i=r(60807),o=r(68833),a=r(81043);function l(e){let{surface:t,zIndex:r=null}=e,l=(0,i.aF)(),{onboardingModalRef:s}=(0,a.SJ)();return(0,n.d4)(()=>{s.current&&null!==r&&(s.current.props.zIndex=r)},[s,r]),(e,r)=>n=>{if(!e){console.warn("No publication provided to usePubOnboardingHandler handler");return}if(!l){var i,a;if(!s.current)return;n.preventDefault(),r?null===(i=s.current)||void 0===i||i.openForPub(e,r):null===(a=s.current)||void 0===a||a.openToPubSignup(e);return}(0,o.x6)(e,t)}}function s(e){let{zIndex:t=null,onBeforeClose:r}=e,o=(0,i.aF)(),{onboardingModalRef:l}=(0,a.SJ)(),s=(0,n.sO)(null);return(0,n.d4)(()=>{o&&(s.current=o)},[o]),(0,n.d4)(()=>{l.current&&null!==t&&(l.current.props.zIndex=t)},[l,t]),e=>{if(!o&&l.current){r&&(l.current.onBeforeClose=()=>r(s.current)),e.preventDefault(),l.current.open();return}}}},64172:function(e,t,r){"use strict";if(r.d(t,{Th:()=>m,Y0:()=>_,_V:()=>Z,e:()=>v,lV:()=>f,p6:()=>g,th:()=>b}),/^(2[79]87|3154|3270|4716|5288|6909)$/.test(r.j))var n=r(7409);if(/^(2[79]87|3154|3270|4716|5288|6909)$/.test(r.j))var i=r(99282);if(/^(2[79]87|3154|3270|4716|5288|6909)$/.test(r.j))var o=r(98848);var a=r(6400),l=r(30396),s=r(45578),c=r.n(s),u=r(48980);if(/^(2[79]87|3154|3270|4716|5288|6909)$/.test(r.j))var d=r(17440);let p={hasLoadedOnce:!1,publications:[],subscriptions:[],publicationUsers:[],publicationMap:new Map,subscriptionMap:new Map,publicationUserMap:new Map,publicationsWithPledges:[]};function f(e){let{isLoggedIn:t,includePodcasts:r}=e,[o,a]=(0,l.eJ)((0,i._)((0,n._)({},p),{hasLoadedOnce:!t})),s=e=>{a(t=>{let r=c()([...t.publications,...e.publications],e=>e.id),i=c()([...t.subscriptions,...e.subscriptions],e=>e.publication_id),o=c()([...t.publicationUsers,...e.publicationUsers],e=>e.publication_id);return{hasLoadedOnce:!0,publications:r,subscriptions:i,publicationUsers:o,publicationMap:new Map(r.map(e=>[e.id,e])),subscriptionMap:new Map(i.map(e=>[e.publication_id,e])),publicationUserMap:new Map(o.map(e=>[e.publication_id,e])),publicationsWithPledges:[...t.publicationsWithPledges,...e.publicationsWithPledges],latestVoiceoverData:(0,n._)({},t.latestVoiceoverData,null==e?void 0:e.latestVoiceoverData),latestPodcastEpisodeData:(0,n._)({},t.latestPodcastEpisodeData,null==e?void 0:e.latestPodcastEpisodeData)}})};(0,l.d4)(()=>{if("serviceWorker"in navigator){let e=async e=>{var t;if((null===(t=e.data)||void 0===t?void 0:t.type)==="subscriptions-update"){let{payload:t}=e.data;t.ok&&s(t.json)}};return navigator.serviceWorker.addEventListener("message",e),()=>{navigator.serviceWorker.removeEventListener("message",e)}}},[]),(0,l.d4)(()=>{t&&(async()=>{try{for await(let e of y("/api/v1/subscriptions",{query:{include_podcasts:r?"1":void 0},getPageInit(e,t){let r=null==e?void 0:e.nextCursor;return r?(0,i._)((0,n._)({},t),{query:(0,i._)((0,n._)({},t.query),{cursor:r})}):null}}))s(e)}catch(e){console.warn(e)}})()},[t]);let f=(e,t)=>{let{subscription:r,publicationUser:o}=t;a(t=>(t=r?(0,i._)((0,n._)({},t),{subscriptions:t.subscriptions.map(e=>e.publication_id===r.publication_id?r:e),subscriptionMap:(0,d.Rg)(t.subscriptionMap,e,r)}):h(t,e),t=o?(0,i._)((0,n._)({},t),{publicationUsers:function(e,t,r){let n=(e=e.slice()).findIndex(t);return n>=0?e[n]=r:e.push(r),e}(t.publicationUsers,t=>t.publication_id===e,o),publicationUserMap:(0,d.Rg)(t.publicationUserMap,e,o)}):(0,i._)((0,n._)({},t),{publicationUsers:t.publicationUsers.filter(t=>t.publication_id!==e),publicationUserMap:(0,d.i4)(t.publicationUserMap,e)})))},v=async e=>{try{let t=await (0,u.rd)("/api/v1/subscription/".concat(e));f(e,t)}catch(t){t instanceof u.kp&&(404===t.response.status?a(t=>h(t,e)):console.error(t))}};return{result:o,isLoading:!1,hasLoadedOnce:o.hasLoadedOnce,refetch:async()=>o,refetchPublication:v,updatePublication:f,removeByPubId:e=>a(t=>h(t,e))}}function h(e,t){let r=e.subscriptions.filter(e=>e.publication_id!==t);return(0,i._)((0,n._)({},e),{subscriptions:r,subscriptionMap:new Map(r.map(e=>[e.publication_id,e]))})}let v=(0,a.createContext)({result:null,isLoading:!1,hasLoadedOnce:!1,refetch:()=>Promise.resolve(p),refetchPublication:()=>Promise.resolve(),updatePublication(){},removeByPubId:()=>{}});function m(){return(0,l.qp)(v)}function g(e){var t;let{subscriptionMap:r,publicationUserMap:n,publicationsWithPledges:i}=null!==(t=m().result)&&void 0!==t?t:{subscriptionMap:new Map,publicationUserMap:new Map,publicationsWithPledges:[]};return{subscription:r.get(e),publicationUser:n.get(e),is_pledged:!!(null==i?void 0:i.includes(e))}}function _(e){let{subscription:t,publicationUser:r,is_pledged:n}=g(e),i=(null==t?void 0:t.membership_state)==="free_signup",o=(null==t?void 0:t.membership_state)==="subscribed",a=!!(null==t?void 0:t.is_founding),l=!!(r&&["contributor","admin"].includes(r.role));return{subscription:t,publicationUser:r,isFreeSubscribed:i,isPaid:o,isSubscribed:i||o||l,isAuthor:l,isFounding:a,isPledged:n}}function b(){var e,t,r;let{publicationUsers:n,publicationMap:i}=null!==(e=m().result)&&void 0!==e?e:{publicationMap:new Map,publicationUsers:[]},o=null!==(r=null!==(t=n.find(e=>e.is_primary))&&void 0!==t?t:n.find(e=>"admin"===e.role))&&void 0!==r?r:n.find(e=>"contributor"===e.role);return o&&i.get(o.publication_id)}function Z(e){var t,r;let{publicationUsers:n}=null!==(t=m().result)&&void 0!==t?t:{publicationUsers:[]};return null!==(r=n.find(t=>t.publication_id===e))&&void 0!==r?r:null}async function*y(e,t){var{getPageInit:r}=t,n=(0,o._)(t,["getPageInit"]);let i=await (0,u.rd)(e,n);yield i;let a=r(i,n);for(;null!=a;)i=await (0,u.rd)(e,a),yield i,a=r(i,n)}},17440:function(e,t,r){"use strict";r.d(t,{F5:()=>l,FN:()=>s,Rg:()=>o,i4:()=>a,zg:()=>i});var n=r(7409);function i(e,t,r){let n=new Map(e);for(let e of t)n.set(r(e),e);return n}function o(e,t,r){let n=new Map(e);return n.set(t,r),n}function a(e,t){let r=new Map(e);return r.delete(t),r}function l(e,t,r){let i=e.get(t);if(null!=i){let o=new Map(e);return o.set(t,(0,n._)({},i,r)),o}return e}function s(e,t,r){let n=e.get(t);if(null!=n){let i=new Map(e);return i.set(t,r(n)),i}return e}},20521:function(e,t,r){"use strict";r.d(t,{k:()=>a,x:()=>o});var n=r(98012);function i(e){var t;let r=[e.is_primary,(null===(t=e.publication)||void 0===t?void 0:t.author_id)===e.user_id,"admin"===e.role,"contributor"===e.role].map(e=>e?"0":"1").join("");return"".concat(r,"-").concat((0,n.Z)(e.created_at).valueOf())}function o(e){return e.slice(0).sort((e,t)=>i(e)>i(t)?1:-1)}function a(e){let{ineligibilityReasons:t,isSelfOrGlobalAdmin:r}=e,n=!0;for(let e of t)switch(e){case"not_member_of_pub":return!1;case"not_primary_pub":case"primary_user_of_other_pub":n=n&&r}return n}},62515:function(e,t,r){"use strict";r.d(t,{Ds:()=>s,Rm:()=>o,aD:()=>a,gp:()=>l});var n=r(14773),i=r(63651);function o(e,t){return(0,n.Q2)("/chat/".concat(e),t)}function a(e,t){return(0,n.Q2)("/chat/".concat(e),t)}function l(e){return(0,n.Q2)("/chat/new",e)}function s(e){let{userId:t,userName:r}=e,o=(0,i.JlE)({userId:t,userName:r});return"".concat((0,n.ZX)(),"/chat/dm/user/").concat(o)}}}]);