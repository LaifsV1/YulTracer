"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["5190"],{36671:function(e,t,i){i.d(t,{Z:()=>r});var n=i(16584),o=i(30396);let r=e=>{let{min:t,max:i,step:r,value:a,onChange:l}=e,d=(0,o.sO)(null),s=(0,o.sO)(null),u=(0,o.I4)(e=>{if(!d.current)return;let{left:n,width:o}=d.current.getBoundingClientRect();l(Math.round((t+Math.max(Math.min(e.clientX-n,o),0)/o*(i-t))/r)*r)},[t,i,r,l]),c=(0,o.I4)(()=>{document.removeEventListener("mousemove",u)},[u]),p=()=>{document.addEventListener("mousemove",u)},v=(a-t)/(i-t)*100;return(0,n.tZ)("div",{className:"range-slider-bhPvhQ",ref:d,onMouseDown:p,onMouseUp:c,onBlur:c,children:(0,n.BX)("div",{className:"range-slider__rail-P4vlSM",children:[(0,n.tZ)("div",{className:"range-slider__track-Q9dod1",style:{width:"".concat(v,"%")}}),(0,n.tZ)("div",{className:"range-slider__thumb-SArpZE",style:{left:"".concat(v,"%")},ref:s,onMouseDown:p})]})})}},4083:function(e,t,i){i.d(t,{i:()=>T});var n=i(7409),o=i(99282),r=i(98848),a=i(16584),l=i(30396),d=i(94184),s=i.n(d),u=i(71212),c=i(80569),p=i.n(c),v=i(61649),m=i(15345),h=i(14068),_=i(89241),f=i(95441),g=i(32246),b=i(68833),y=i(98914),C=i(15771),Z=i(19081),w=i(70379),E=i(60308),P=i(82021);let T=e=>{var t;let{postId:i,visible:d,videoPlayerRef:u}=e,c=(0,r._)(e,["postId","visible","videoPlayerRef"]),{onCancelClipping:p}=(0,v.Sr)(),[m,_]=(0,l.eJ)(!1),[f,C]=(0,l.eJ)(),w=()=>{if(d){var t,n,o,r;null===(n=u.current)||void 0===n||null===(t=n.player)||void 0===t||t.pause(),(0,b.j)(b.FP.VIDEO_CLIP_CREATE_MODAL_CLOSED,{post_id:null!=i?i:null===(o=e.post)||void 0===o?void 0:o.id}),c.hideBottomControls||(0,b.j)(b.FP.MEDIA_CLIP_CREATE_MODAL_CLOSED,{video_upload_id:c.videoUpload.id,post_id:null!=i?i:null===(r=e.post)||void 0===r?void 0:r.id,is_post_editor:!1})}p()},E=async e=>{var t,i;C({id:(0,y.EH)(),created_at:new Date,media_upload_id:c.videoUpload.id,title:null!==(i=null===(t=c.post)||void 0===t?void 0:t.slug)&&void 0!==i?i:"",start_time:e.start,duration:e.duration,source:"user",assets:[],user_id:null,description:""}),_(!0)};return((0,h.Z)(e.containerRef,w),d)?(0,a.BX)(Z.gq,{className:s()(P.Z.videoTrimmerSlider,{[P.Z.videoTrimmerSliderVisible]:d}),children:[(0,a.tZ)(k,(0,o._)((0,n._)({},c),{videoPlayerRef:u,onCancel:w,onSubmit:E})),f&&(0,a.tZ)(g._,{videoUpload:c.videoUpload,transcription:null===(t=c.videoUpload.extractedAudio)||void 0===t?void 0:t.transcription,isOpen:m,onClose:()=>{_(!1),p()},clip:f,useDownloadsCenter:!0,surface:"post_view"})]}):null},k=e=>{let{hideBottomControls:t,isInline:i,videoPlayerRef:r,videoUpload:d,post:s,pub:c,onCancel:h,onSubmit:g}=e,y=(0,w.pm)(),Z=(0,m.Gi)(),{iString:P}=(0,f.M1)();(0,l.d4)(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);let T=async e=>{var t,i;(0,b.j)(b.FP.VIDEO_CLIP_CREATE_BUTTON_CLICKED,{post_id:null==s?void 0:s.id,media_upload_id:null==s?void 0:null===(t=s.videoUpload)||void 0===t?void 0:t.id,start_time:e.start,end_time:e.start+e.duration}),r&&setTimeout(()=>{var e,t;return null===(t=r.current)||void 0===t?void 0:null===(e=t.player)||void 0===e?void 0:e.pause()},100);try{let t=await p().post("/api/v1/video/assets/".concat(null==d?void 0:d.id,"/clips")).send(e);return Z.addMediaUpload({mediaUpload:t.body.mediaUpload,thumbnailUrl:(0,E.kOB)(d),title:null!==(i=null==s?void 0:s.title)&&void 0!==i?i:P("Download"),source:"user"}),h(),e}catch(e){console.error(e),y.popToast(e=>(0,a.tZ)(w.FN,(0,o._)((0,n._)({},e),{text:P("Error creating clip")})))}};return(0,a.tZ)(_.g,{hideBottomControls:t,isInline:i,videoPlayerRef:r,videoUpload:d,post:s,pub:c,onSubmit:null!=g?g:T,onSubmitLabel:e=>(0,a.tZ)(C.zx,{leading:(0,a.tZ)(u.Z,{size:20}),onClick:e,children:P("Create clip")}),minClipDuration:v.AT,maxClipDuration:v.ar,minTimelineDuration:v.Zl,maxTimelineDuration:v.eD})}},59488:function(e,t,i){i.d(t,{c:()=>a});var n=i(30396),o=i(23493),r=i.n(o);let a=e=>{let{idleAfter:t=3e3,element:i}=e,[o,a]=(0,n.eJ)(!1);return(0,n.d4)(()=>{let e;let n=null!=i?i:window,o=()=>{a(!0)},l=r()(()=>{a(!1),clearTimeout(e),e=setTimeout(o,t)},500),d=()=>{document.hidden||l()};return e=setTimeout(o,t),n.addEventListener("mousemove",l),n.addEventListener("mousedown",l),n.addEventListener("resize",l),n.addEventListener("keydown",l),n.addEventListener("touchstart",l),n.addEventListener("wheel",l),i||document.addEventListener("visibilitychange",d),()=>{n.removeEventListener("mousemove",l),n.removeEventListener("mousedown",l),n.removeEventListener("resize",l),n.removeEventListener("keydown",l),n.removeEventListener("touchstart",l),n.removeEventListener("wheel",l),i||document.removeEventListener("visibilitychange",d),clearTimeout(e)}},[i,t]),{isIdle:o}}},9459:function(e,t,i){i.d(t,{L:()=>T});var n=i(7409),o=i(99282),r=i(16584),a=i(30396),l=i(94184),d=i.n(l),s=i(10120),u=i(61649),c=i(12281),p=i(4083),v=i(95441),m=i(69181),h=i(59488),_=i(98422),f=i(71068),g=i(75822),b=i(18618),y=i(74571),C=i(47968),Z=i(70958),w=i(61527),E=i(31377);let P={"preview-label-container":"preview-label-container-Y88jiD",previewLabelContainer:"preview-label-container-Y88jiD","live-stream-tag-container":"live-stream-tag-container-MWmvAX",liveStreamTagContainer:"live-stream-tag-container-MWmvAX","media-clip-tag-container":"media-clip-tag-container-FbCpZr",mediaClipTagContainer:"media-clip-tag-container-FbCpZr",videoContainer:"videoContainer-wF4DEO",overflow:"overflow-ns9Lj9",notesVideoContainer:"notesVideoContainer-XgGhEY"},T=e=>{var t,i,l,T,k;let{clipInfo:L,disableAutoPlay:S=!1,forceAutoPlay:A=!1,isFreeSubscribed:B,isSubscribed:I,isLiveStream:U=!1,mediaUpload:D,post:N,pub:X,startMuted:x,variant:R="notes",videoPlayerRef:M,videoType:O="post",entityKey:z,entityType:F,primaryEntityType:V,primaryEntityKey:W,surface:j,contentType:q,feedItemTrackingParameters:K}=e,{isClipping:Y}=(0,u.Sr)(),{iString:J}=(0,v.M1)(),{isMobile:G}=(0,_.v9)(),[H,Q]=(0,a.eJ)(!1),$=(0,E.isPaidAudience)(N.audience)&&!I,ee=(null!==(i=D.preview_duration)&&void 0!==i?i:0)>0,et=$&&(!ee||H),ei=!1;if(L&&ee&&$){let e=null!==(l=D.preview_start)&&void 0!==l?l:0,t=e+(null!==(T=D.preview_duration)&&void 0!==T?T:0),i=L.startTime,n=i+L.duration;ei=i<e||n>t}(0,g.KS)({videoPlayerRef:M,showPaywall:et,disable:S});let en=(0,a.sO)(null),[eo,er]=(0,a.eJ)(!1),{isIdle:ea}=(0,h.c)({idleAfter:2e3,element:en.current}),el=(0,s.r)(),ed=(0,y.Ml)(en),es={mediaRef:M,pub:X,post:N,mediaUpload:D,podcastUpload:null==D?void 0:D.extractedAudio,isActive:null!==(k=eo||!ea||Y)&&void 0!==k&&k,isFocused:ed,handle:el,hasPaywall:$,hideNextVideoButton:!0,showPaywall:et,onShareMenuOpen:()=>er(!0),onShareMenuClose:()=>er(!1),disableShortcuts:!0,size:"notes"===R?"sm":"md",hideSettings:!!L,hidePip:!!L};return(0,r.tZ)(f.xu,{ref:en,position:"relative",onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,r.BX)(s.I,{handle:el,className:P.fullScreenContainer,children:[(0,r.BX)("div",{className:d()(P.videoContainer,{[P.overflow]:Y,[P.notesVideoContainer]:"notes"===R,[P.inboxVideoContainer]:"inbox"===R}),children:[(0,r.tZ)(c.Z,{ref:M,doNotResetOnEnd:!0,hidePlayButton:et,mediaUpload:D,noControls:!0,noKeyboardShortcuts:!0,post:N,pub:X,startMuted:x,onFinishVideo:()=>{Q(!0)},renderPlayButton:()=>(0,r.tZ)(b.fI,{isPlaying:!1,size:G?40:56}),isClipping:Y,videoType:O,usePreview:$&&ee,videoPlayerClassName:P.videoPlayer,autoPlay:A&&!et,entityKey:z,entityType:F,primaryEntityKey:W,primaryEntityType:V,surface:j,contentType:q,feedItemTrackingParameters:K}),L&&!L.isAutoSelected?(0,r.tZ)(w.to,(0,o._)((0,n._)({},es),{startTime:L.startTime,duration:L.duration})):(0,r.tZ)(w.Vo,(0,n._)({},es))]}),(null===(t=M.current)||void 0===t?void 0:t.player)&&"post"===O&&(0,r.tZ)(p.i,{visible:Y,videoPlayerRef:M,containerRef:en,videoUpload:D,post:N}),ee&&!et&&!I&&(0,r.tZ)("div",{className:P["preview-label-container"],children:(0,r.tZ)(Z.l,{children:J("Preview")})}),!(ee&&!et&&!I)&&U&&(0,r.tZ)("div",{className:P["live-stream-tag-container"],children:(0,r.tZ)(m.j0,{})}),et&&(0,r.tZ)(C.Y,{post:N,pub:X,isFreeSubscribed:B,isPaidClip:ei,medium:"video",variant:"dialog",onRestart:ee&&!ei?()=>{var e;(null===(e=M.current)||void 0===e?void 0:e.player)&&(Q(!1),M.current.player.currentTime=0,M.current.player.play())}:void 0})]})})}},47968:function(e,t,i){i.d(t,{Y:()=>Y});var n=i(7409),o=i(99282),r=i(58865),a=i(16584),l=i(30396),d=i(94184),s=i.n(d),u=i(13639),c=i(25425),p=i(84488),v=i(98661),m=i(80569),h=i.n(m),_=i(83034),f=i(45530),g=i(95441),b=i(56629),y=i(60807),C=i(68833),Z=i(98914),w=i(98422),E=i(94874),P=i(15771),T=i(19081),k=i(58175),L=i(70379),S=i(24791),A=i(60308),B=i(47929),I=i(64830);function U(){let e=(0,r._)(["Available now for iOS and Android"]);return U=function(){return e},e}function D(){let e=(0,r._)(["Continue watching this video for free in the Substack app"]);return D=function(){return e},e}function N(){let e=(0,r._)(["Continue watching this video for free, courtesy of ","."]);return N=function(){return e},e}function X(){let e=(0,r._)(["Continue listening for free in the Substack app"]);return X=function(){return e},e}function x(){let e=(0,r._)(["Continue listening for free, courtesy of ","."]);return x=function(){return e},e}function R(){let e=(0,r._)(["Watch this video for free in the Substack app"]);return R=function(){return e},e}function M(){let e=(0,r._)(["Watch this video for free, courtesy of ","."]);return M=function(){return e},e}function O(){let e=(0,r._)(["Listen to this episode for free in the Substack app"]);return O=function(){return e},e}function z(){let e=(0,r._)(["Listen to this episode for free, courtesy of ","."]);return z=function(){return e},e}function F(){let e=(0,r._)([""," episode"]);return F=function(){return e},e}function V(){let e=(0,r._)(["The full episode is only available to "," subscribers"]);return V=function(){return e},e}function W(){let e=(0,r._)(["The full episode is only available to paid subscribers of ",""]);return W=function(){return e},e}function j(){let e=(0,r._)([""," clip"]);return j=function(){return e},e}function q(){let e=(0,r._)(["This clip is only available to "," subscribers"]);return q=function(){return e},e}function K(){let e=(0,r._)(["This clip is only available to paid subscribers of ",""]);return K=function(){return e},e}let Y=e=>{var t,i,r,d;let{disableButtons:m,medium:f,inlineIcon:Y,isFreeSubscribed:G,isPaidClip:H,post:Q,pub:$,variant:ee,onRestart:et,magicToken:ei}=e,{iString:en,iTemplate:eo}=(0,g.M1)(),{isMobile:er}=(0,w.v9)(),[ea,el]=(0,l.eJ)(!1),{getSettingFor:ed}=(0,b.So)(),es=(0,y.aF)(),{popToast:eu}=(0,L.pm)(),ec=!!(ed("paywall_unlock_tokens")&&"only_paid"===Q.audience&&Q.teaser_post_eligible)&&!(null==es?void 0:es.is_subscribed)&&G&&!(null==es?void 0:es.has_redeemed_post_unlock_token),ep=null==es?void 0:es.reader_installed_at,{modal:ev,open:em}=(0,_.useAppModal)({utm_campaign:B.VX.paywallPostUnlockPrompt,utm_source:B.b3.substack,overrideCTA:null!==(t=ep&&en("Open in app"))&&void 0!==t?t:void 0,overrideTitle:ep?en("Unlock your free post in the Substack app"):en("Get the free Substack app to unlock this post"),subTitle:eo(U()),openUrl:null!==(i=ep&&(0,A.K8_)($.subdomain,Q.slug))&&void 0!==i?i:void 0}),eh=(0,v.useCallback)(async()=>{(0,C.j)(C.FP.PAYWALL_UNLOCK_CTA_CLICKED,{post_id:Q.id,publication_id:$.id,medium:f});try{await h().post("/api/v1/post_unlock_token").send({post_id:Q.id,token:ei}),er?window.location.href=ep?(0,A.K8_)($.subdomain,Q.slug,{redirect:"app-store",params:{utm_campaign:B.VX.paywallPostUnlockPrompt,utm_source:B.b3.paywall,utm_medium:f}}):(0,A.D4e)({utm_campaign:B.VX.paywallPostUnlockPrompt,utm_source:B.b3.paywall,utm_medium:f}):em()}catch(e){eu(e=>(0,a.tZ)(L.FN,(0,o._)((0,n._)({},e),{text:en("Teaser posts are not currently available for this content")})))}},[Q.id,Q.slug,$.id,$.subdomain,f,ei,ep,em,eu,en,er]),e_=!!et,ef=null!==(r=(0,S.H$)($))&&void 0!==r?r:"Founding Member",eg=ec?et?"video"===f?er?eo(D()):eo(N(),$.author_name||$.name):er?eo(X()):eo(x(),$.author_name||$.name):"video"===f?er?eo(R()):eo(M(),$.author_name||$.name):er?eo(O()):eo(z(),$.author_name||$.name):"founding"===Q.audience?eo(F(),ef):en("Paid episode"),eb="founding"===Q.audience?eo(V(),ef):eo(W(),$.name);2309160===$.id?(eg=en("Watch the film"),eb="Subscribe or purchase as a 1-month rental to continue."):H&&(eg="founding"===Q.audience?eo(j(),ef):en("Paid clip"),eb="founding"===Q.audience?eo(q(),ef):eo(K(),$.name));let ey="video"===f?en("Subscribe to watch"):en("Subscribe to listen"),eC=ec?en("Claim my free episode"):"video"===f?en("Upgrade to watch"):en("Upgrade to listen"),eZ=ec?()=>{eh()}:()=>{(0,Z.uX)((0,A.Zs0)($,{simple:!0,next:document.location.href,utm_source:B.b3.showsPaywall,utm_medium:B.lP.web,utm_content:Q.id}),{local_navigation:!1})},ew=G?eC:ey;return(0,l.d4)(()=>{(0,C.j)(C.FP.FREE_PREVIEW_PAYWALL_SHOWN,{post_id:Q.id,medium:f})},[Q.id,f]),(0,l.d4)(()=>{e_&&setTimeout(()=>{el(!0)},10)},[e_]),(0,a.BX)(T.gq,{className:s()(I.Z.container,{[I.Z["container--dialog"]]:"dialog"===ee,[I.Z["container--overlay"]]:"overlay"===ee,[I.Z["container--animated"]]:e_,[I.Z["container--animated-in"]]:ea}),inset:0,justifyContent:"center",alignItems:"center",position:"absolute",onClick:e=>{e.stopPropagation(),e.preventDefault()},"data-testid":"paywall",children:[ev,"dialog"===ee?(0,a.tZ)(J,{showUnlockPrompt:ec,description:eb,headerText:eg,post:Q,pub:$,primaryCta:ew,primaryCtaClick:eZ,onRestart:et}):(0,a.BX)(T.tu,{alignItems:"center",gap:er?12:16,paddingX:24,children:[(0,a.BX)(T.tu,{alignItems:"center",className:I.Z["content-top"],gap:er?12:16,children:[!Y&&(ec?(0,a.tZ)(E.qE,{photoUrl:null!==(d=$.author_photo_url)&&void 0!==d?d:void 0,size:64}):(0,a.tZ)(T.gq,{className:I.Z["icon-container"],alignItems:"center",color:"white",justifyContent:"center",radius:"sm",children:(0,a.tZ)(u.Z,{size:er?16:24})})),(0,a.BX)(T.tu,{alignItems:"center",gap:4*!er,children:[(0,a.BX)(T.gq,{alignItems:"center",gap:8,children:[Y&&(0,a.tZ)(T.gq,{className:I.Z.inlineIconContainer,alignItems:"center",justifyContent:"center",radius:"sm",children:(0,a.tZ)(u.Z,{size:16})}),(0,a.tZ)(k.xv.B3,{as:"h3",color:"white",weight:"semibold",fontSize:ec?20:15,textAlign:"center",children:eg})]}),!ec&&(0,a.tZ)(k.xv.B4,{color:"white",opacity:80,align:"center",children:eb})]})]}),(0,a.BX)(T.gq,{className:I.Z["content-bottom"],gap:16,children:[et&&(0,a.tZ)(P.zx,{className:I.Z["restart-button"],disabled:m,priority:"secondary-outline",onClick:()=>{(0,C.j)(C.FP.FREE_PREVIEW_PAYWALL_RESTART_BUTTON_CLICKED,{post_id:Q.id}),et()},children:(0,a.BX)(T.gq,{alignItems:"center",gap:12,children:[(0,a.tZ)(c.Z,{size:16}),en("Restart")]})}),(0,a.BX)(P.zx,{priority:"primary",onClick:eZ,disabled:m,children:[ec&&(0,a.tZ)(p.Z,{className:"icon",size:20,stroke:"#fff",fill:"none",strokeWidth:2}),ew]})]})]})]})},J=e=>{var t;let{description:i,headerText:n,post:o,pub:r,primaryCtaClick:l,primaryCta:d,onRestart:s,showUnlockPrompt:c}=e,{iString:p}=(0,g.M1)();return(0,a.BX)(T.tu,{bg:"glass-inverted-medium",padding:16,gap:16,radius:"md",maxWidth:320,children:[(0,a.BX)(T.tu,{gap:4,alignItems:"center",children:[c&&(0,a.tZ)(E.qE,{photoUrl:null!==(t=r.author_photo_url)&&void 0!==t?t:void 0,size:64}),(0,a.BX)(T.gq,{alignItems:"center",color:"white",gap:8,children:[!c&&(0,a.tZ)(u.Z,{size:16}),(0,a.tZ)(k.xv.B2,{as:"h3",color:"white",weight:"semibold",textAlign:c?"center":"left",children:n})]}),!c&&(0,a.tZ)(k.xv.B4,{color:"white",opacity:80,align:"center",children:i})]}),(0,a.BX)(T.tu,{gap:8,children:[s&&(0,a.tZ)(P.zx,{priority:"primary-mono",onClick:()=>{(0,C.j)(C.FP.FREE_PREVIEW_PAYWALL_RESTART_BUTTON_CLICKED,{post_id:o.id}),s()},children:p("Replay")}),(0,a.BX)(P.zx,{onClick:l,priority:"secondary",children:[c&&(0,a.tZ)(f.Z,{size:18,className:I.Z.icon}),d]})]})]})}},70958:function(e,t,i){i.d(t,{l:()=>a});var n=i(16584),o=i(19081),r=i(58175);let a=e=>{let{children:t,avoidBackgroundBlur:i}=e;return(0,n.tZ)(o.gq,{alignItems:"center",bg:i?void 0:"glass-inverted-medium",color:"white",gap:6,height:24,paddingX:8,radius:"sm","data-testid":"audio-player-preview-label",style:i?{background:"var(--color-light-fg-primary)"}:void 0,children:(0,n.tZ)(r.xv.B5,{weight:"medium",color:"white",children:t})})}}}]);