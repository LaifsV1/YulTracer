"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7777"],{58474:function(e,t,r){r.d(t,{Qe:()=>S,iL:()=>C,k2:()=>x,zw:()=>Z});var o=r(7409),n=r(16584),l=r(30396),a=r(57061),i=r(36781),s=r(33804),c=r(63049),u=r(53687),d=r(44404),p=r(95441),_=r(68833),h=r(98914),v=r(15771),g=r(19081),m=r(6490),b=r(63474),w=r(96302),f=r(58175),y=r(35500),T=r(60308),E=r(15181);let k=(e,t)=>{var r;let{postCoverImageUrl:o,pubCoverImageUrl:n,pub:l,themeVariables:a}=t,i=[],s=[],c=!1,u=a||l.theme,d=null!==(r=(null==u?void 0:u.web_bg_color)||(null==u?void 0:u.cover_bg_color))&&void 0!==r?r:"";switch(e){case"post_asset":o&&i.push("image"),((null==u?void 0:u.background_pop_color)||(null==u?void 0:u.background_pop))&&i.push("accent"),i.push("primary"),"#ffffff"!==d.toLowerCase()&&i.push("black&white"),c=!0;break;case"pub_shareable_image":n&&i.push("image"),i.push("primary"),s.push({type:"logo",label:"Logo"}),l.has_posts&&s.push({type:"posts",label:"Top posts"}),l.hero_text&&s.push({type:"description",label:"Description"});break;case"paid_subscription":case"pledged_subscription":((null==u?void 0:u.background_pop_color)||(null==u?void 0:u.background_pop))&&i.push("accent"),i.push("primary")}return{assetThemes:i,assetTypes:s,includePreviewTextToggle:c}};function C(e){var t;let r,b,w,f,C,D,{pub:O,item:P,isOpen:B,setOpen:M,themeVariables:N,width:R}=e,{iString:L}=(0,p.M1)(),{type:j,target_user:W,target_user_id:G,target_pledge_note:X,target_subscription_note:F,post:U}=P,q=O.logo_url||O.cover_photo_url||O.author_photo_url||(null===(t=O.author)||void 0===t?void 0:t.photo_url),V=null==U?void 0:U.cover_image,z="post_asset"===j,{assetThemes:J,assetTypes:K,includePreviewTextToggle:H}=k(j,{postCoverImageUrl:V,pubCoverImageUrl:q,pub:O,themeVariables:N}),Q=N||O.theme,[$,Y]=(0,l.eJ)(z?"instagram":"stories"),[ee,et]=(0,l.eJ)(J.find(e=>"image"===e)&&q?"image":J.find(e=>"accent"===e)&&((null==Q?void 0:Q.background_pop_color)||(null==Q?void 0:Q.background_pop))?"accent":"primary"),[er,eo]=(0,l.eJ)("logo");(0,l.d4)(()=>{B&&(0,_.j)(_.FP.SHARE_CENTER_CUSTOMIZE_ASSETS_MODAL_OPENED)},[B]);let[en,el]=(0,l.eJ)(!0),ea=()=>{switch(ee){case"image":return(0,o._)({aspectRatio:$,bgImage:!0},K.length&&{type:er},H&&en&&{hidePreviewText:!0});case"accent":return(0,o._)({aspectRatio:$,bgColor:(null==Q?void 0:Q.background_pop_color)||(null==Q?void 0:Q.background_pop),textColor:null==Q?void 0:Q.print_on_pop},K.length&&{type:er},H&&en&&{hidePreviewText:!0});case"primary":return(0,o._)({aspectRatio:$,bgColor:(null==Q?void 0:Q.web_bg_color)||(null==Q?void 0:Q.cover_bg_color),textColor:(null==Q?void 0:Q.print_on_web_bg_color)||(null==Q?void 0:Q.cover_print_primary)},K.length&&{type:er},H&&en&&{hidePreviewText:!0});default:return(0,o._)({aspectRatio:$,bgColor:"#ffffff",textColor:"#404040"},K.length&&{type:er},H&&en&&{hidePreviewText:!0})}},ei=(0,h.K1)(),es=()=>{M(!1)};switch(j){case"arr_10k_milestone":w=y.dD.ARR10K,b=(0,n.tZ)(a.d,{pub:O,milestone:w,style:{aspectRatio:$}}),f=(0,T.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"arr_1k_milestone":w=y.dD.ARR1K,b=(0,n.tZ)(a.d,{pub:O,milestone:w,style:{aspectRatio:$}}),f=(0,T.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"list_100_milestone":w=y.bq.List100,b=(0,n.tZ)(a.d,{pub:O,milestone:w,style:{aspectRatio:$}}),f=(0,T.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"list_1k_milestone":w=y.bq.List1K,b=(0,n.tZ)(a.d,{pub:O,milestone:w,style:{aspectRatio:$}}),f=(0,T.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"paid_subscription":b=(0,n.tZ)(d.uP,{pub:O,note:F,user:W||{id:G||0},style:ea()}),f=(0,T.gGz)(O,W||{id:G||0},ea(),{fileToDownload:"Message - ".concat("stories"===$?"vertical":$)}),D=()=>{(0,_.j)(_.FP.SUBSCRIPTION_NOTE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{note_from_user_id:(null==W?void 0:W.id)||G,aspectRatio:$,source:"download-button"})};break;case"pledged_subscription":b=(0,n.tZ)(d.hi,{pub:O,note:X,user:W||{id:G||0},style:ea()}),f=(0,T.uQO)(O,W||{id:G||0},ea(),{fileToDownload:"Message - ".concat("stories"===$?"vertical":$)}),D=()=>{(0,_.j)(_.FP.PLEDGE_NOTE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{note_from_user_id:(null==W?void 0:W.id)||G,aspectRatio:$,source:"download-button"})};break;case"pub_shareable_image":r=L("Create shareable image"),b=(0,n.tZ)(c.H,{pub:O,style:ea()}),C="".concat(O.name," - ").concat("stories"===$?"vertical":$),f=(0,T.p5u)(O,null,ea(),{fileToDownload:C}),D=()=>{(0,_.j)(_.FP.PUBLICATION_MEDIA_ASSETS_IMAGE_DOWNLOADED,{aspectRatio:$,source:"download-button"})};break;case"post_asset":{let e=ea(),{text:t,translatedText:o}="image"===ee?{text:"Image".concat(en?" - no preview":""),translatedText:L(en?"Image - no preview":"Image")}:"accent"===ee?{text:"Accent Color".concat(en?" - no preview":""),translatedText:L(en?"Accent Color - no preview":"Accent Color")}:"primary"===ee?{text:"Background Color".concat(en?" - no preview":""),translatedText:L(en?"Background Color - no preview":"Background Color")}:{text:"Black and White".concat(en?" - no preview":""),translatedText:L(en?"Black and White - no preview":"Black and White")};r=L("Create shareable image"),b=U&&(0,n.tZ)(i.Z,{pub:O,post:U,style:e,translatedText:o,size:420,hoverOverlay:!1}),C="".concat(o," - ").concat("stories"===$?"vertical":$),f=U&&(0,T.ChS)(O,U,e,C),D=()=>{(0,_.j)(_.FP.WRITER_MEDIA_ASSETS_IMAGE_DOWNLOADED,{post_id:null==U?void 0:U.id,type:t,aspectRatio:e.aspectRatio,share_center:!0,inline:!1,source:"download-button"})}}}["arr_10k_milestone","arr_1k_milestone","list_100_milestone","list_1k_milestone"].includes(j)?(r=L("Share milestone"),C="".concat(w," - ").concat("stories"===$?"vertical":$),D=()=>{(0,_.j)(_.FP.MILESTONE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{milestone:w,aspectRatio:$,source:"download-button"})}):["paid_subscription","pledged_subscription"].includes(j)&&(r=L("Share message"),C="Message - ".concat("stories"===$?"vertical":$));let ec=async()=>{null==D||D();let e=document.createElement("a");e.href=f,e.download=C,e.target="_blank",e.rel="noopener noreferrer",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},eu=J.length>1,ed=K.length>1,ep=u.sl.length>1;return(0,n.tZ)(m.u_,{isOpen:B,onClose:es,width:R||640,overflow:"hidden",renderOverReactLaagPortal:!0,fullscreenMobile:!0,children:(0,n.BX)(s.w,{children:[(0,n.tZ)(m.xB,{onClose:es,title:r,showClose:!0,showDivider:!0}),(0,n.tZ)(m.fe,{children:(0,n.BX)(g.tu,{gap:20,children:[(0,n.tZ)(g.hs,{className:E.Z.imageContainer,alignItems:"center",justifyContent:"center",children:b}),(0,n.BX)(x,{children:[eu&&(0,n.tZ)(S,{assetThemes:J,assetTheme:ee,setAssetTheme:et,theme:Q,pubCoverImageUrl:q}),ed&&(0,n.tZ)(A,{assetTypes:K,assetType:er,setAssetType:eo}),ep&&(0,n.tZ)(Z,{aspectRatio:$,setAspectRatio:Y,includeInstagram:z}),H&&(0,n.tZ)(I,{hidePreviewText:en,setHidePreviewText:el})]})]})}),!ei&&(0,n.tZ)(m.mz,{showDivider:!0,direction:"column",primaryButton:(0,n.tZ)(v.zx,{priority:"primary",onClick:ec,children:L("Download image")})})]})})}function S(e){let{assetThemes:t,assetTheme:r,setAssetTheme:o,theme:l,pubCoverImageUrl:a}=e;return(0,n.BX)(g.tu,{gap:8,children:[(0,n.tZ)(f.xv.B4,{weight:"medium",translated:!0,children:"Background"}),(0,n.tZ)(g.gq,{gap:8,children:t.map(e=>(0,n.tZ)(u.rn,{value:e,isSelected:e===r,onClick:()=>o(e),themeVariables:l,coverImageUrl:a}))})]})}function A(e){let{assetTypes:t,assetType:r,setAssetType:o}=e;return(0,n.BX)(g.tu,{gap:8,children:[(0,n.tZ)(f.xv.B4,{weight:"medium",translated:!0,children:"Type"}),(0,n.tZ)(g.gq,{gap:8,children:t.map(e=>{let{type:t,label:l}=e;return(0,n.tZ)(u.$I,{label:l,isSelected:t===r,onClick:()=>o(t)})})})]})}function Z(e){let{aspectRatio:t,setAspectRatio:r,includeInstagram:o}=e,l=o?u.sl:u.sl.filter(e=>"instagram"!==e);return(0,n.BX)(g.tu,{gap:8,children:[(0,n.tZ)(f.xv.B4,{weight:"medium",translated:!0,children:"Aspect Ratio"}),(0,n.tZ)(g.gq,{gap:8,children:l.map(e=>(0,n.tZ)(u.ar,{value:e,isSelected:e===t,onClick:()=>r(e)}))})]})}function I(e){let{hidePreviewText:t,setHidePreviewText:r}=e;return(0,n.BX)(g.tu,{gap:8,children:[(0,n.tZ)(f.xv.B4,{weight:"medium",translated:!0,children:"Preview Text"}),(0,n.tZ)(g.hs,{flex:"grow",alignItems:"center",children:(0,n.tZ)(w.rs,{checked:!t,onChange:e=>{r(!e),(0,_.j)(_.FP.SHARE_CENTER_CUSTOMIZE_ASSETS_PREVIEW_TEXT_TOGGLED,{includePreviewText:e})}})})]})}let x=(0,b.zo)({display:"flex",gap:20,overflowX:"auto",flex:"auto",justifyContent:"space-between"})},42347:function(e,t,r){r.d(t,{At:()=>s});var o=r(16584),n=r(98661);let l={name:null,version:null,major:null},a={chrome:130,firefox:130,safari:16,edge:130},i=(0,n.createContext)({browser:l,isSupported:!0});function s(e){let{browser:t=l,children:r}=e,s=(0,n.useMemo)(()=>{let{name:e,version:r,major:o}=t,n=!0,l=a[null==e?void 0:e.toLowerCase()];return e&&l&&(n=!!(r&&o&&Number(o)>=l)),{browser:t,isSupported:n}},[t]);return(0,o.tZ)(i.Provider,{value:s,children:r})}},75822:function(e,t,r){r.d(t,{KS:()=>u,qS:()=>c});var o=r(16584),n=r(6400),l=r(30396),a=r(60807);let i=(0,n.createContext)({registerVideo:()=>void 0,unregisterVideo:()=>void 0,updatePaywallState:()=>void 0}),s=()=>(0,l.qp)(i),c=e=>{let{children:t}=e,[r,n]=(0,l.eJ)(0),s=(0,l.sO)([]),c=(0,l.sO)(new Map),u=(0,a.Fl)().autoPlayVideo;(0,l.d4)(()=>{let e=new IntersectionObserver(e=>{e.forEach(e=>{let t=e.target;if(!e.isIntersecting){t.pause();return}!c.current.get(t)&&u&&t.play().catch(e=>{console.log("Unable to autoplay prior to user interaction with the dom.",e),t.muted=!0,t.play().catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom when muted.",e)})})})},{threshold:1});return s.current.forEach(t=>{var r;(null===(r=t.current)||void 0===r?void 0:r.player)&&e.observe(t.current.player)}),()=>{s.current.forEach(t=>{var r;(null===(r=t.current)||void 0===r?void 0:r.player)&&e.unobserve(t.current.player)})}},[r]);let d=(0,l.I4)(e=>{e&&!s.current.includes(e)&&(s.current.push(e),n(e=>e+1))},[]),p=(0,l.I4)(e=>{s.current=s.current.filter(t=>t!==e),n(e=>e+1)},[]),_=(0,l.I4)(e=>{var t;let{videoPlayerRef:r,showPaywall:o}=e;(null===(t=r.current)||void 0===t?void 0:t.player)&&c.current.set(r.current.player,o)},[]);return(0,o.tZ)(i.Provider,{value:{registerVideo:d,unregisterVideo:p,updatePaywallState:_},children:t})},u=e=>{let{disable:t,showPaywall:r,videoPlayerRef:o}=e,{registerVideo:n,unregisterVideo:a,updatePaywallState:i}=s();(0,l.d4)(()=>{if(o.current&&!t)return n(o),()=>{a(o)}},[t,n,a,o]),(0,l.d4)(()=>{i({showPaywall:r,videoPlayerRef:o})},[r,i,o])}}}]);